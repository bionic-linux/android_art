{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "19fdd19b_2ac217ac",
        "filename": "dex2oat/dex2oat.cc",
        "patchSetId": 1
      },
      "lineNbr": 1116,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2023-10-03T09:30:06Z",
      "side": 1,
      "message": "Chatted offline with Martin; `CompactDexLevel::kCompactDexLevelNone` seems to be the default already:\n\nhttps://cs.android.com/android/platform/superproject/main/+/main:art/dexlayout/dexlayout.h;l\u003d69;drc\u003d63aae1fc09ff4216726ce916c8d6b77ae26311b1\n\n```\n  CompactDexLevel compact_dex_level_ \u003d CompactDexLevel::kCompactDexLevelNone;\n```",
      "range": {
        "startLine": 1116,
        "startChar": 0,
        "endLine": 1116,
        "endChar": 70
      },
      "revId": "779eec14c2a20e72c2958f4024fa4e9a143920a7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8c1bff6d_904d7fbf",
        "filename": "dex2oat/dex2oat_options.cc",
        "patchSetId": 1
      },
      "lineNbr": 430,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2023-10-03T08:51:19Z",
      "side": 1,
      "message": "? why this change?",
      "range": {
        "startLine": 430,
        "startChar": 47,
        "endLine": 430,
        "endChar": 55
      },
      "revId": "779eec14c2a20e72c2958f4024fa4e9a143920a7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b7e9ec1c_2774fb6e",
        "filename": "dex2oat/dex2oat_options.cc",
        "patchSetId": 1
      },
      "lineNbr": 430,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2023-10-03T09:04:06Z",
      "side": 1,
      "message": "To avoid a lie in case the P/H flag is true.",
      "parentUuid": "8c1bff6d_904d7fbf",
      "range": {
        "startLine": 430,
        "startChar": 47,
        "endLine": 430,
        "endChar": 55
      },
      "revId": "779eec14c2a20e72c2958f4024fa4e9a143920a7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b36af0c3_b2a2108e",
        "filename": "dex2oat/dex2oat_options.cc",
        "patchSetId": 1
      },
      "lineNbr": 430,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2023-10-03T09:28:27Z",
      "side": 1,
      "message": "Then maybe drop the obsolete and say what it does?",
      "parentUuid": "b7e9ec1c_2774fb6e",
      "range": {
        "startLine": 430,
        "startChar": 47,
        "endLine": 430,
        "endChar": 55
      },
      "revId": "779eec14c2a20e72c2958f4024fa4e9a143920a7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ac103f97_14c390df",
        "filename": "runtime/oat_file_assistant.cc",
        "patchSetId": 1
      },
      "lineNbr": 1290,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2023-10-03T09:30:06Z",
      "side": 1,
      "message": "Suggestion: Remove this comment, as a similar comment precedes the declaration of this method (maybe in a follow-up CL).",
      "range": {
        "startLine": 1287,
        "startChar": 0,
        "endLine": 1290,
        "endChar": 36
      },
      "revId": "779eec14c2a20e72c2958f4024fa4e9a143920a7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4e8c63c5_ed3fa221",
        "filename": "runtime/oat_file_assistant.cc",
        "patchSetId": 1
      },
      "lineNbr": 1302,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-10-03T10:27:12Z",
      "side": 1,
      "message": "If I understand this code correctly, a change to the flag from \"false\" to \"true\" doesn\u0027t trigger re-compilation. To ensure a meaningful experiment, I think the logic should be the opposite: if we have cdex, it\u0027s okay because the cdex will eventually go away; if we don\u0027t have cdex and the flag is on, we should invalidate standard dex and generate cdex, \n\nIf we implement that logic, we need to be careful that we shouldn\u0027t invalidate standard dex when `--compact-dex-level` is `none`, to avoid repetitive compilation. This is hard because we don\u0027t know the value of `--compact-dex-level` here. I can see two options:\n\n1. Pass the value of `--compact-dex-level` from ART Service to here. This means we can only do the experiment on U devices, so the population will be limited.\n2. Change dex2oat to always override `--compact-dex-level` to `fast` when the experiment flag is on, and assume `--compact-dex-level\u003dfast` here.",
      "range": {
        "startLine": 1292,
        "startChar": 0,
        "endLine": 1302,
        "endChar": 47
      },
      "revId": "779eec14c2a20e72c2958f4024fa4e9a143920a7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}