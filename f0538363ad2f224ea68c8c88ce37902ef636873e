{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "f73fd7bb_3afdd9f5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1258954
      },
      "writtenOn": "2021-05-07T09:30:39Z",
      "side": 1,
      "message": "Other than the below comment, LGTM.",
      "revId": "f0538363ad2f224ea68c8c88ce37902ef636873e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "494ef0a7_c897b44f",
        "filename": "test/2040-huge-native-alloc/huge_native_buf.cc",
        "patchSetId": 2
      },
      "lineNbr": 2,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2021-05-07T10:38:23Z",
      "side": 1,
      "message": "Nit: 2021",
      "range": {
        "startLine": 2,
        "startChar": 17,
        "endLine": 2,
        "endChar": 21
      },
      "revId": "f0538363ad2f224ea68c8c88ce37902ef636873e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "52692563_98dc4be2",
        "filename": "test/2040-huge-native-alloc/huge_native_buf.cc",
        "patchSetId": 2
      },
      "lineNbr": 2,
      "author": {
        "id": 1042828
      },
      "writtenOn": "2021-05-07T16:37:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "494ef0a7_c897b44f",
      "range": {
        "startLine": 2,
        "startChar": 17,
        "endLine": 2,
        "endChar": 21
      },
      "revId": "f0538363ad2f224ea68c8c88ce37902ef636873e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8be838cf_a2d6fe2b",
        "filename": "test/2040-huge-native-alloc/huge_native_buf.cc",
        "patchSetId": 2
      },
      "lineNbr": 33,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2021-05-07T10:38:23Z",
      "side": 1,
      "message": "Nit: Remove space.",
      "range": {
        "startLine": 33,
        "startChar": 28,
        "endLine": 33,
        "endChar": 29
      },
      "revId": "f0538363ad2f224ea68c8c88ce37902ef636873e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "94d6b162_5acab4b8",
        "filename": "test/2040-huge-native-alloc/huge_native_buf.cc",
        "patchSetId": 2
      },
      "lineNbr": 33,
      "author": {
        "id": 1042828
      },
      "writtenOn": "2021-05-07T16:37:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8be838cf_a2d6fe2b",
      "range": {
        "startLine": 33,
        "startChar": 28,
        "endLine": 33,
        "endChar": 29
      },
      "revId": "f0538363ad2f224ea68c8c88ce37902ef636873e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0865591b_bc3b0c66",
        "filename": "test/2040-huge-native-alloc/src/Main.java",
        "patchSetId": 2
      },
      "lineNbr": 70,
      "author": {
        "id": 1258954
      },
      "writtenOn": "2021-05-07T09:30:39Z",
      "side": 1,
      "message": "Wouldn\u0027t this get optimized out by the compiler? Maybe have a static variable to hold the buffer each time?",
      "range": {
        "startLine": 68,
        "startChar": 2,
        "endLine": 70,
        "endChar": 5
      },
      "revId": "f0538363ad2f224ea68c8c88ce37902ef636873e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2e1c8dab_6b82e79b",
        "filename": "test/2040-huge-native-alloc/src/Main.java",
        "patchSetId": 2
      },
      "lineNbr": 70,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2021-05-07T10:38:23Z",
      "side": 1,
      "message": "In theory, yes, but I don\u0027t think that this would happen in practice, because AFAIU there is no logic in the compiler that would try to optimize BufferHolder\u0027s finalizer.\n\nAlso, I think keeping references to the allocated BufferHolder objects might defeat the purpose of this test.",
      "parentUuid": "0865591b_bc3b0c66",
      "range": {
        "startLine": 68,
        "startChar": 2,
        "endLine": 70,
        "endChar": 5
      },
      "revId": "f0538363ad2f224ea68c8c88ce37902ef636873e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b4d51dd8_b6fd88ca",
        "filename": "test/2040-huge-native-alloc/src/Main.java",
        "patchSetId": 2
      },
      "lineNbr": 70,
      "author": {
        "id": 1258954
      },
      "writtenOn": "2021-05-07T11:43:00Z",
      "side": 1,
      "message": "I\u0027m not a code optimization expert, but looking at this code snippet it looks so obvious that the objects aren\u0027t being held, so why not eliminate it ðŸ˜Š\n\nI was suggesting having a single static holder and overwriting it in the loop.",
      "parentUuid": "2e1c8dab_6b82e79b",
      "range": {
        "startLine": 68,
        "startChar": 2,
        "endLine": 70,
        "endChar": 5
      },
      "revId": "f0538363ad2f224ea68c8c88ce37902ef636873e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9921f91f_8b772132",
        "filename": "test/2040-huge-native-alloc/src/Main.java",
        "patchSetId": 2
      },
      "lineNbr": 70,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2021-05-07T11:53:38Z",
      "side": 1,
      "message": "\u003e I\u0027m not a code optimization expert, but looking at this code snippet it looks so obvious that the objects aren\u0027t being held, so why not eliminate it ðŸ˜Š\n\nAt first glance, yes, but the compiler must ensure that any transformation preserves the behavior of the program (according to the runtime\u0027s specification). In this case, BufferHolder\u0027s constructor has a side effect (calling a native method) that the compiler cannot elide (or even understand). Same thing with the finalizer (once the object is constructed).",
      "parentUuid": "b4d51dd8_b6fd88ca",
      "range": {
        "startLine": 68,
        "startChar": 2,
        "endLine": 70,
        "endChar": 5
      },
      "revId": "f0538363ad2f224ea68c8c88ce37902ef636873e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "25f1b245_fd8373fa",
        "filename": "test/2040-huge-native-alloc/src/Main.java",
        "patchSetId": 2
      },
      "lineNbr": 70,
      "author": {
        "id": 1042828
      },
      "writtenOn": "2021-05-07T16:21:12Z",
      "side": 1,
      "message": "As Roland said, I don\u0027t think this is much of a concern. The Java conpiler would have to optimize out the native allocation somehow. We\u0027re nowhere near that. Currently, if we do optimize this out, we want tests to fail :-)",
      "parentUuid": "9921f91f_8b772132",
      "range": {
        "startLine": 68,
        "startChar": 2,
        "endLine": 70,
        "endChar": 5
      },
      "revId": "f0538363ad2f224ea68c8c88ce37902ef636873e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}