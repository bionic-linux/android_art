{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "b6b930a4_d106514b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1071150
      },
      "writtenOn": "2021-03-16T17:38:26Z",
      "side": 1,
      "message": "PTAL, a first attempt at adding metrics in odrefresh. Thanks!",
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e5135eff_2c813dfb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1335232
      },
      "writtenOn": "2021-03-16T18:24:06Z",
      "side": 1,
      "message": "Overall, this looks really good! I added a few comments and questions.",
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ec905c16_29b13a0c",
        "filename": "odrefresh/odrefresh.cc",
        "patchSetId": 6
      },
      "lineNbr": 1287,
      "author": {
        "id": 1335232
      },
      "writtenOn": "2021-03-16T18:24:06Z",
      "side": 1,
      "message": "Hmm, I wonder if we should add ISA as another piece of metadata. Do you think it\u0027s worth being able to slice metrics by ISA?",
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c7e71813_eaaeaf10",
        "filename": "odrefresh/odrefresh.cc",
        "patchSetId": 6
      },
      "lineNbr": 1287,
      "author": {
        "id": 1071150
      },
      "writtenOn": "2021-03-16T19:19:23Z",
      "side": 1,
      "message": "Interesting question!\n\nOn the one hand the world is slowly drifting to 64-bit, but we\u0027re not there yet.\n\nOn the other there is a lot of diversity within an ISA (e.g. ARM core version). If we can correlate a report to a device type then running odrefresh doesn\u0027t take very long.\n\nWould we emit a separate report per arch? Or add counters per arch. The latter might get quite cumbersome.",
      "parentUuid": "ec905c16_29b13a0c",
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d0d06e89_12ead708",
        "filename": "odrefresh/odrefresh.cc",
        "patchSetId": 6
      },
      "lineNbr": 1287,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2021-03-16T19:34:32Z",
      "side": 1,
      "message": "We had the same discussion on PM-dex2oat reporting. \n\nI think we should add the ISA, otherwise you need to always remember that you will get twice the number of metrics and need to make sure how you add/average.\n\n+Yan",
      "parentUuid": "c7e71813_eaaeaf10",
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "17dcd3b3_a229d7ae",
        "filename": "odrefresh/odrefresh.cc",
        "patchSetId": 6
      },
      "lineNbr": 1287,
      "author": {
        "id": 1071150
      },
      "writtenOn": "2021-03-17T13:27:29Z",
      "side": 1,
      "message": "Do we have any way of tagging architecture or do we have to duplicate the counters?",
      "parentUuid": "d0d06e89_12ead708",
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a84fe90c_d55399df",
        "filename": "odrefresh/odrefresh.cc",
        "patchSetId": 6
      },
      "lineNbr": 1287,
      "author": {
        "id": 1335232
      },
      "writtenOn": "2021-03-17T17:47:47Z",
      "side": 1,
      "message": "It seems like the best approach would be to add another field to ArtDatumReported that includes the ISA. We could use that both here and for PM-dex2oat.",
      "parentUuid": "17dcd3b3_a229d7ae",
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c589e058_2562a7e0",
        "filename": "odrefresh/odrefresh.cc",
        "patchSetId": 6
      },
      "lineNbr": 1287,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2021-03-18T00:02:48Z",
      "side": 1,
      "message": "A new dimension would be better I think. We can also use for the runtime-metrics as well (knowing which arch the process is running)",
      "parentUuid": "a84fe90c_d55399df",
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "22803f21_d24754e4",
        "filename": "odrefresh/odrefresh.cc",
        "patchSetId": 6
      },
      "lineNbr": 1322,
      "author": {
        "id": 1335232
      },
      "writtenOn": "2021-03-16T18:24:06Z",
      "side": 1,
      "message": "The session id should normally be a randomly generated number. See https://cs.android.com/android/platform/superproject/+/master:art/runtime/runtime.cc;l\u003d1085;bpv\u003d1;bpt\u003d1 for an example.\n\nFor right now I don\u0027t think that\u0027s an issue, since I don\u0027t think we\u0027ll need to correlate multiple reports as there is only one report from odrefresh. So, 0 should work, but a random number would be better in case things change.",
      "range": {
        "startLine": 1322,
        "startChar": 44,
        "endLine": 1322,
        "endChar": 61
      },
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "733f5de0_86b6c043",
        "filename": "odrefresh/odrefresh.cc",
        "patchSetId": 6
      },
      "lineNbr": 1322,
      "author": {
        "id": 1071150
      },
      "writtenOn": "2021-03-16T19:19:23Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "22803f21_d24754e4",
      "range": {
        "startLine": 1322,
        "startChar": 44,
        "endLine": 1322,
        "endChar": 61
      },
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "dc2ff15b_0d737428",
        "filename": "odrefresh/odrefresh.cc",
        "patchSetId": 6
      },
      "lineNbr": 1323,
      "author": {
        "id": 1335232
      },
      "writtenOn": "2021-03-16T18:24:06Z",
      "side": 1,
      "message": "The user id is what we use to correlate metrics with a particular app, since we also get a user id to app mapping with our metrics. For something like dex2oat it can make sense to use the uid of the app that\u0027s being compiled rather than dex2oat\u0027s uid.\n\nIn this case, since we\u0027re just doing System Server and the boot classpath, the uid of the app probably isn\u0027t particularly relevant, so using odrefresh\u0027s uid should be fine.\n\nAnyway, I bring this up just in case you think a different uid might be valuable.",
      "range": {
        "startLine": 1323,
        "startChar": 44,
        "endLine": 1323,
        "endChar": 86
      },
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0d8ddb3d_ee098710",
        "filename": "odrefresh/odrefresh.cc",
        "patchSetId": 6
      },
      "lineNbr": 1323,
      "author": {
        "id": 1071150
      },
      "writtenOn": "2021-03-16T19:19:23Z",
      "side": 1,
      "message": "Ack, thanks.",
      "parentUuid": "dc2ff15b_0d737428",
      "range": {
        "startLine": 1323,
        "startChar": 44,
        "endLine": 1323,
        "endChar": 86
      },
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bdd1afb0_157039e2",
        "filename": "odrefresh/odrefresh.cc",
        "patchSetId": 6
      },
      "lineNbr": 1327,
      "author": {
        "id": 1335232
      },
      "writtenOn": "2021-03-16T18:24:06Z",
      "side": 1,
      "message": "It doesn\u0027t really matter for correctness, but I think conceptually it makes more sense to have the BeginReport call just before ReportAllMetrics, so that all the reporting related calls are right together.",
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4d9bfe00_99fdc88a",
        "filename": "odrefresh/odrefresh.cc",
        "patchSetId": 6
      },
      "lineNbr": 1327,
      "author": {
        "id": 1071150
      },
      "writtenOn": "2021-03-16T19:19:23Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "bdd1afb0_157039e2",
      "revId": "f7954c1afeb1d47410bf092c4ea34a1d914e3514",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}