{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "08e2ff75_3f8bd2c9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2021-04-29T16:25:15Z",
      "side": 1,
      "message": "What\u0027s the impact on the size? Should this be backed by a flag for devices with limited storage space?",
      "revId": "3369bd01d96b67d5d7cd7af87771ad5db941978f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c9f91b0d_49e526a1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1558410
      },
      "writtenOn": "2021-04-29T18:09:36Z",
      "side": 1,
      "message": "In-memory size should not be affected, on-disk size.\nlibart.so: 8726416 -\u003e 10098576\nlibart-compiler.so: 3305640 -\u003e 6426816\n\nIs there an existing solution for flagging off options for low storage devices.",
      "parentUuid": "08e2ff75_3f8bd2c9",
      "revId": "3369bd01d96b67d5d7cd7af87771ad5db941978f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c057fcb2_2aa21f67",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2021-04-29T20:17:44Z",
      "side": 1,
      "message": "I think you can have a board config flag to configure this. +ccross in how this could be integrated.\n\nThis is about 5MB storage increase and maybe not such a big concern, but I would check with someone working with such devices to understand the expectations. + rajekumar +tjoinnes\n\nAlso, I\u0027m assuming you want to do this on a larger scale (not only to art .so) so gating it might be a good idea.",
      "parentUuid": "c9f91b0d_49e526a1",
      "revId": "3369bd01d96b67d5d7cd7af87771ad5db941978f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3b94498d_eb2b2cfb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1148397
      },
      "writtenOn": "2021-04-29T20:21:34Z",
      "side": 1,
      "message": "No objection from me on the 5MB disk space hit. I\u0027m not sure our kernels will support THP to start though. I defer to Rajeev\u0027s judgement.",
      "parentUuid": "c057fcb2_2aa21f67",
      "revId": "3369bd01d96b67d5d7cd7af87771ad5db941978f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0e7a8fe8_3eadd6a0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1248808
      },
      "writtenOn": "2021-04-29T20:30:18Z",
      "side": 1,
      "message": "5MB disk space hit is not super concerning if it can lead to the significant performance improvements. Maybe we should also capture performance improvements data on a Wembley device. \n\nIn general having a config flag to enable/disable it is a great idea and I agree with Calin\u0027s suggestions about it.",
      "parentUuid": "3b94498d_eb2b2cfb",
      "revId": "3369bd01d96b67d5d7cd7af87771ad5db941978f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ce8abf57_6ffda432",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1558410
      },
      "writtenOn": "2021-04-29T21:25:15Z",
      "side": 1,
      "message": "Per ccross@, \"We generally discourage config variables as much as possible because it inevitably leads to breakages of branches that are not tested in presubmit. If there is no objection to turning it on globally I\u0027d leave out the config variable.\" Are we alright with moving forward with a a global enable",
      "parentUuid": "0e7a8fe8_3eadd6a0",
      "revId": "3369bd01d96b67d5d7cd7af87771ad5db941978f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2c2401a6_624703c3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2021-04-30T08:49:17Z",
      "side": 1,
      "message": "We would like to know the benefits before doing so - ART is now a mainline module and any size increase has consequences. We also don\u0027t want to produce different binaries whether running on Go or regular Android.",
      "parentUuid": "ce8abf57_6ffda432",
      "revId": "3369bd01d96b67d5d7cd7af87771ad5db941978f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7750c6e2_a3c1d7f3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2021-04-30T09:16:26Z",
      "side": 1,
      "message": "We would also like to know more about how transparent huge pages work to determine what are the actual benefits.\n\nWith this CL: The tail part of a section (say .text) can be a lot less that 2MiB. Are we going to use a huge page for the tail and waste valuable RAM? (I assume we cannot reuse the rest of the physical page for other small-page data as that could be potentially used as a side-channel for that data.)\n\nWithout this CL: If a section is bigger than 2MiB and happens to cover an entire aligned 2MiB area, would we not use a huge page anyway? (Which would mean that this CL is useful only for the head and tail parts, with the above concern about the tail.)",
      "parentUuid": "2c2401a6_624703c3",
      "revId": "3369bd01d96b67d5d7cd7af87771ad5db941978f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e7bacb1a_d4797957",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1558410
      },
      "writtenOn": "2021-04-30T15:45:04Z",
      "side": 1,
      "message": "THPs will only be used for full 2MB chunks of the section, so the tail will stay on 4KB pages.\n\nBoth VMA and file offset both need to be 2MB aligned to use THPs, this can lead to hugepages covering different functions or not being used at all when there is no explicit alignment.",
      "parentUuid": "7750c6e2_a3c1d7f3",
      "revId": "3369bd01d96b67d5d7cd7af87771ad5db941978f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}