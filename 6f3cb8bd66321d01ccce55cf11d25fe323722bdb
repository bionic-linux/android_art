{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "c015a54a_404393fc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2022-11-16T13:51:21Z",
      "side": 1,
      "message": "Thanks all!",
      "revId": "6f3cb8bd66321d01ccce55cf11d25fe323722bdb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b6c083c6_25fb48c6",
        "filename": "compiler/art_standalone_compiler_tests.xml",
        "patchSetId": 1
      },
      "lineNbr": 17,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-11-09T20:11:28Z",
      "side": 1,
      "message": "I\u0027m not very familiar with this mechanism, but I suppose this means we don\u0027t aim to do much module presubmit testing in AOSP?",
      "range": {
        "startLine": 17,
        "startChar": 78,
        "endLine": 17,
        "endChar": 84
      },
      "revId": "6f3cb8bd66321d01ccce55cf11d25fe323722bdb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9862964c_cad1000d",
        "filename": "compiler/art_standalone_compiler_tests.xml",
        "patchSetId": 1
      },
      "lineNbr": 17,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2022-11-09T23:55:30Z",
      "side": 1,
      "message": "I\u0027m not sure this bit of the configuration is actually required to run Mainline Presubmits via Test Mapping (in AOSP or elsewhere) – I think this is only necessary for Atest to be able to run tests declared in the `mainline-presubmit` test group of a `TEST_MAPPING` file (with the `atest --test-mapping art:mainline-presubmit` syntax), where the module(s) to install prior to running the tests are listed in bracket (see e.g. https://cs.android.com/android/platform/superproject/+/master:art/TEST_MAPPING;l\u003d8;drc\u003d9c686f5ce600b00f1cf8da118cec4d21f9a21d38).\n\nAs for AOSP, I never managed to use Atest to run tests from the `mainline-presubmit` test group with ART\u0027s `TEST_MAPPING` file in an AOSP tree. I\u0027ll file a feature request to the Atest team, as a follow-up to b/183523684.",
      "parentUuid": "b6c083c6_25fb48c6",
      "range": {
        "startLine": 17,
        "startChar": 78,
        "endLine": 17,
        "endChar": 84
      },
      "revId": "6f3cb8bd66321d01ccce55cf11d25fe323722bdb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "afc7746b_6d42c6fa",
        "filename": "compiler/art_standalone_compiler_tests.xml",
        "patchSetId": 1
      },
      "lineNbr": 17,
      "author": {
        "id": 1330217
      },
      "writtenOn": "2022-11-10T07:56:44Z",
      "side": 1,
      "message": "Mainline module was aimed to run on Google devices from the previous requirement. To run in AOSP, there was another requirement to automatically map the google version apk/apex to AOSP version, but the requirement was not clear enough, so we only support running google version mainline modules for now.\n\nTo clarify this, it\u0027s not used for ATest locally only, but used in presubmit as well.",
      "parentUuid": "9862964c_cad1000d",
      "range": {
        "startLine": 17,
        "startChar": 78,
        "endLine": 17,
        "endChar": 84
      },
      "revId": "6f3cb8bd66321d01ccce55cf11d25fe323722bdb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0f34c451_030bb2fd",
        "filename": "compiler/art_standalone_compiler_tests.xml",
        "patchSetId": 1
      },
      "lineNbr": 17,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-11-11T10:50:15Z",
      "side": 1,
      "message": "\u003e I\u0027m not sure this bit of the configuration is actually required to run Mainline Presubmits via Test Mapping (in AOSP or elsewhere) – I think this is only necessary for Atest to be able to run tests declared in the mainline-presubmit test group of a TEST_MAPPING file\n\nThe way I read it, that only leaves local atest use, but Chun-Yi\u0027s comment says differently then?",
      "parentUuid": "afc7746b_6d42c6fa",
      "range": {
        "startLine": 17,
        "startChar": 78,
        "endLine": 17,
        "endChar": 84
      },
      "revId": "6f3cb8bd66321d01ccce55cf11d25fe323722bdb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6044cce8_db91a7bf",
        "filename": "compiler/art_standalone_compiler_tests.xml",
        "patchSetId": 1
      },
      "lineNbr": 17,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2022-11-16T13:51:21Z",
      "side": 1,
      "message": "Chun-Yi Lee:\n\n\u003e To clarify this, it\u0027s not used for ATest locally only, but used in presubmit as well.\n\nThanks for the clarification, Chun-Yi.\n\nMartin Stjernholm:\n\n\u003e The way I read it, that only leaves local atest use, but Chun-Yi\u0027s comment says differently then?\n\nYes, from Chun-Yi\u0027s comment this change also seems to affect Mainline Presubmits via Test Mapping, but I\u0027m not sure how, as it seemed to me that those tests were able to run in pre-submit (and maybe post-submit) testing without this CL. To be explored…",
      "parentUuid": "0f34c451_030bb2fd",
      "range": {
        "startLine": 17,
        "startChar": 78,
        "endLine": 17,
        "endChar": 84
      },
      "revId": "6f3cb8bd66321d01ccce55cf11d25fe323722bdb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6f63720d_18b09ab9",
        "filename": "compiler/art_standalone_compiler_tests.xml",
        "patchSetId": 1
      },
      "lineNbr": 17,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2022-11-16T16:31:57Z",
      "side": 1,
      "message": "\u003e Yes, from Chun-Yi\u0027s comment this change also seems to affect Mainline Presubmits via Test Mapping, but I\u0027m not sure how, as it seemed to me that those tests were able to run in pre-submit (and maybe post-submit) testing without this CL. To be explored…\n\nSo I was wrong: it seems some tests were not run _at all_ as part of Mainline Presubmits via Test Mapping, because of the missing metadata (that is being added by this CL). Case in point: `libnativeloader_e2e_tests` is now failing when run against an Android S platform in this CL\u0027s presubmits:\n\n```\nThere were 2 failures:\n  value of:\n    installPackage(...)\nexpected:\n    null\nbut was:\n    Unknown failure: Exception occurred while executing \u0027install\u0027:\n    java.lang.IllegalArgumentException: Error: Failed to parse APK file: /data/local/tmp/loadlibrarytest_data_app.apk: Requires development platform UpsideDownCake but this is a release platform.\n    at com.android.server.pm.PackageManagerShellCommand.setParamsSize(PackageManagerShellCommand.java:581)\n    at com.android.server.pm.PackageManagerShellCommand.doRunInstall(PackageManagerShellCommand.java:1337)\n    at com.android.server.pm.PackageManagerShellCommand.runInstall(PackageManagerShellCommand.java:1303)\n    at com.android.server.pm.PackageManagerShellCommand.onCommand(PackageManagerShellCommand.java:193)\n    at com.android.modules.utils.BasicShellCommandHandler.exec(BasicShellCommandHandler.java:97)\n    at android.os.ShellCommand.exec(ShellCommand.java:38)\n    at com.android.server.pm.PackageManagerService.onShellCommand(PackageManagerService.java:24612)\n    at android.os.Binder.shellCommand(Binder.java:950)\n    at android.os.Binder.onTransact(Binder.java:834)\n    at android.content.pm.IPackageManager$Stub.onTransact(IPackageManager.java:4818)\n    at com.android.server.pm.PackageManagerService.onTransact(PackageManagerService.java:8506)\n    at android.os.Binder.execTransactInternal(Binder.java:1184)\n    at android.os.Binder.execTransact(Binder.java:1143)\n  Exception with no error message\n```\n\n(and so are some `JniCompilerTest` test cases in `art_standalone_compiler_tests`).\n\nI\u0027ll investigate these failures.",
      "parentUuid": "6044cce8_db91a7bf",
      "range": {
        "startLine": 17,
        "startChar": 78,
        "endLine": 17,
        "endChar": 84
      },
      "revId": "6f3cb8bd66321d01ccce55cf11d25fe323722bdb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "643466ae_6f533545",
        "filename": "compiler/art_standalone_compiler_tests.xml",
        "patchSetId": 1
      },
      "lineNbr": 17,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-11-16T17:05:32Z",
      "side": 1,
      "message": "I see, thanks. I can confirm that libnativeloader_e2e_tests requires root, which implies a debug build.",
      "parentUuid": "6f63720d_18b09ab9",
      "range": {
        "startLine": 17,
        "startChar": 78,
        "endLine": 17,
        "endChar": 84
      },
      "revId": "6f3cb8bd66321d01ccce55cf11d25fe323722bdb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}