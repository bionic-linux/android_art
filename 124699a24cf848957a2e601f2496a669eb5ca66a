{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "e1190b34_c35dc907",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1039338
      },
      "writtenOn": "2020-12-16T19:00:21Z",
      "side": 1,
      "message": "One of the additional changes you need.",
      "revId": "124699a24cf848957a2e601f2496a669eb5ca66a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c0daa09f_9a243a31",
        "filename": "build/sdk/Android.bp",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2021-01-19T23:55:59Z",
      "side": 1,
      "message": "Does it work to extract the dex files from the APEX for these?",
      "range": {
        "startLine": 88,
        "startChar": 0,
        "endLine": 91,
        "endChar": 28
      },
      "revId": "124699a24cf848957a2e601f2496a669eb5ca66a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "55467c4f_0bbdff00",
        "filename": "build/sdk/Android.bp",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1039338
      },
      "writtenOn": "2021-01-20T10:06:59Z",
      "side": 1,
      "message": "Yes. The dex files are made available through the java_import and it doesn\u0027t matter whether that java_import is created for a module listed here or elsewhere.\n\nWhat matters is that they are listed in the prebuilt_apex as added in https://r.android.com/1531910.",
      "parentUuid": "c0daa09f_9a243a31",
      "range": {
        "startLine": 88,
        "startChar": 0,
        "endLine": 91,
        "endChar": 28
      },
      "revId": "124699a24cf848957a2e601f2496a669eb5ca66a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0645f863_4c756726",
        "filename": "build/sdk/Android.bp",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2021-01-20T10:57:25Z",
      "side": 1,
      "message": "I see. So that\u0027s something that would complicate matters if we decide to autogenerate the prebuilt_apex Android.bp\u0027s.\n\nCould you add to the comment that they still need to be mentioned in exported_java_libs for the prebuilt_apex modules?",
      "parentUuid": "55467c4f_0bbdff00",
      "range": {
        "startLine": 88,
        "startChar": 0,
        "endLine": 91,
        "endChar": 28
      },
      "revId": "124699a24cf848957a2e601f2496a669eb5ca66a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "885e4243_304839a9",
        "filename": "build/sdk/Android.bp",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1039338
      },
      "writtenOn": "2021-01-20T14:08:37Z",
      "side": 1,
      "message": "Yes, it would complicate the auto generation of prebuilt_apex Android.bp\u0027s. I am not sure that it will be an issue longer term though. The dex implementation jars are, AFAIK, only used for boot package check and building the boot image\u0027s .art file that is used by dexpreopt. If the boot package check is done when we create the ART apex (or maybe even as part of creating the ART boot image) rather than when we build the system image and we can export the boot image\u0027s .art file for use by dexpreopt then we may not need to export the dex implementation jars at all. In which case this would be removed and replaced by a boot_images property instead.\n\nUpdated the comment as requested.",
      "parentUuid": "0645f863_4c756726",
      "range": {
        "startLine": 88,
        "startChar": 0,
        "endLine": 91,
        "endChar": 28
      },
      "revId": "124699a24cf848957a2e601f2496a669eb5ca66a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f4d9b78f_9c8ac0ca",
        "filename": "build/sdk/Android.bp",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2021-01-20T14:50:40Z",
      "side": 1,
      "message": "\u003e then we may not need to export the dex implementation jars at all\n\nInteresting. I didn\u0027t know that the .art files in the boot images was the only reason for getting the .dex\u0027es out of the APEXes.",
      "parentUuid": "885e4243_304839a9",
      "range": {
        "startLine": 88,
        "startChar": 0,
        "endLine": 91,
        "endChar": 28
      },
      "revId": "124699a24cf848957a2e601f2496a669eb5ca66a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b65378fd_8dd17443",
        "filename": "build/sdk/Android.bp",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2021-01-20T15:06:08Z",
      "side": 1,
      "message": "What about the BOOT_JARS_CHECK ?",
      "parentUuid": "f4d9b78f_9c8ac0ca",
      "range": {
        "startLine": 88,
        "startChar": 0,
        "endLine": 91,
        "endChar": 28
      },
      "revId": "124699a24cf848957a2e601f2496a669eb5ca66a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ac387c42_44a64c58",
        "filename": "build/sdk/Android.bp",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1039338
      },
      "writtenOn": "2021-01-20T16:21:27Z",
      "side": 1,
      "message": "I did mention that in my previous comment but yes that check which is performed when we build the system image does also require the dex files. However, if we can move/split that check so it is only performed on the ART dex files when building from ART source then that would remove the only other known (to me at least) use of the dex implementation jars.",
      "parentUuid": "b65378fd_8dd17443",
      "range": {
        "startLine": 88,
        "startChar": 0,
        "endLine": 91,
        "endChar": 28
      },
      "revId": "124699a24cf848957a2e601f2496a669eb5ca66a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}