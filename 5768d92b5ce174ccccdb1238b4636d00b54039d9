{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "5ac1d608_bdb56f77",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1894735
      },
      "writtenOn": "2024-04-11T09:50:38Z",
      "side": 1,
      "message": "Hi Christopher, is this the CL Artem mentioned in yesterday\u0027s meeting about simulator build system changes? Is it ready for a review or do you just want us to take a quick look to see everything is okay.",
      "revId": "5768d92b5ce174ccccdb1238b4636d00b54039d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e1997e0e_45c7e8dc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1989777
      },
      "writtenOn": "2024-04-11T14:18:47Z",
      "side": 1,
      "message": "Yes this patch along with https://android-review.googlesource.com/c/platform/art/+/2680024 and https://android-review.googlesource.com/c/platform/art/+/2680026 were the ones referenced.\n\nFor now a quick look to check the design is okay, would be greatly appreciated while a full review can wait while some of the earlier patches are addressed.",
      "parentUuid": "5ac1d608_bdb56f77",
      "revId": "5768d92b5ce174ccccdb1238b4636d00b54039d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5471ffa2_44b78c59",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1894735
      },
      "writtenOn": "2024-04-25T14:04:08Z",
      "side": 1,
      "message": "Thanks for the patches! We had a few discussions with Martin and Jiakai who know build system much better than I do. I will add them to the three CLs. They will be happy to provide high level feedback now. They are busy with Android release currently and can do a in-depth review maybe in June. Hope that\u0027s okay with you. \n\nOne more question here, I was looking at an old doc on how to build and test simulator and that refers to a art/test/README.simulator.md. I couldn\u0027t find it any of the patches or already checked in to the repo. Could you please point me to the Readme please?",
      "parentUuid": "e1997e0e_45c7e8dc",
      "revId": "5768d92b5ce174ccccdb1238b4636d00b54039d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1d7b9b67_39a19586",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1894735
      },
      "writtenOn": "2024-04-25T14:05:44Z",
      "side": 1,
      "message": "Jiakai and Martin, these are the patches we discussed. They aren\u0027t ready for thorough review yet but high-level feedback on the approach would be great.",
      "revId": "5768d92b5ce174ccccdb1238b4636d00b54039d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6277e5db_df281801",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1989777
      },
      "writtenOn": "2024-04-25T14:59:35Z",
      "side": 1,
      "message": "\u003e They are busy with Android release currently and can do a in-depth review maybe in June. Hope that\u0027s okay with you.\n\nSounds great, thanks!\n\n\u003e Could you please point me to the Readme please?\n\nSure, it\u0027s part of the [Stage 1 simulator support patch](https://android-review.googlesource.com/c/platform/art/+/2680028/3/test/README.simulator.md).\n\nTo give you some more context about building and testing the simulator; the reason we haven\u0027t updated that old document or marked the simulator specific patches (marked \"[Sim]\") ready for review yet, is because [this patch](https://github.com/Linaro/vixl/pull/93) is needed in VIXL to support implicit checks in ART. Once that patch is merged we will update the simulator guide document and the rest of the simulator patches will be available for review and testing.",
      "parentUuid": "5471ffa2_44b78c59",
      "revId": "5768d92b5ce174ccccdb1238b4636d00b54039d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e9c1039f_7ea6cb8a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1894735
      },
      "writtenOn": "2024-04-25T15:14:55Z",
      "side": 1,
      "message": "Thanks for the Readme! IIUC, we are building both host and target to be able to run the simulator right? Do we need the target build only to get the boot image?  If yes, I think we can avoid that by either building the boot image separately or by modifying the build script to build a target image in the host build itself. \n\nOne more question, The boot image should be targeted to arm64 right? We don\u0027t need the x86_64 boot image right?",
      "parentUuid": "6277e5db_df281801",
      "revId": "5768d92b5ce174ccccdb1238b4636d00b54039d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "16190120_1b3aeeb0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1989777
      },
      "writtenOn": "2024-04-25T15:42:47Z",
      "side": 1,
      "message": "\u003e IIUC, we are building both host and target to be able to run the simulator right?\n\nYes both the host and target need to be built to be able to run the simulator.\n\n\u003e Do we need the target build only to get the boot image?\n\nNo, the target build is done to build the ART run tests (images). The target boot image is built separately as part of [[Sim] Build target boot image for simulator](https://android-review.googlesource.com/c/platform/art/+/2680024/3).\n\n\u003e One more question, The boot image should be targeted to arm64 right? We don\u0027t need the x86_64 boot image right?\n\nYes the arm64 boot image is used and the x86_64 boot image is built as part of the host build but ignored.\n\nNote: we intentionally chose to use the existing host and target builds within the ART testing infrastructure to keep the simulator build as close to regular production builds as possible. This way there are only a few small changes specific to the simulator inside the ART test scripts.",
      "parentUuid": "e9c1039f_7ea6cb8a",
      "revId": "5768d92b5ce174ccccdb1238b4636d00b54039d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1cea4bf9_a1c525e0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1894735
      },
      "writtenOn": "2024-04-29T08:50:23Z",
      "side": 1,
      "message": "Thanks! I missed the building of tests themselves. I was wondering if we are building target only to get the boot image. This clarifies things now.",
      "parentUuid": "16190120_1b3aeeb0",
      "revId": "5768d92b5ce174ccccdb1238b4636d00b54039d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0b32524f_5a194275",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1989777
      },
      "writtenOn": "2024-05-29T08:33:03Z",
      "side": 1,
      "message": "FYI [this change](https://android-review.googlesource.com/c/platform/art/+/2680024/comment/a2fc8ae0_ea567cdb/) to generating the boot image, now means that the target build is also needed to make the files needed to generate the boot image.",
      "parentUuid": "1cea4bf9_a1c525e0",
      "revId": "5768d92b5ce174ccccdb1238b4636d00b54039d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "67d867bf_7583e092",
        "filename": "build/quick_code_arch.go",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2024-04-25T15:47:54Z",
      "side": 1,
      "message": "Could you please explore using Soong config variables to avoid having this logic in a go file? https://android.googlesource.com/platform/build/soong/+/refs/heads/main/README.md#soong-config-variables",
      "revId": "5768d92b5ce174ccccdb1238b4636d00b54039d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f6be024e_b7715b33",
        "filename": "build/quick_code_arch.go",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1894735
      },
      "writtenOn": "2024-04-29T08:50:23Z",
      "side": 1,
      "message": "Just to expand on this. The separation of architecture specific files to quick_code_arch is good. We are now using this go file to append quick_code_arch files into the correct arch. Instead if we made quick_code_arch as a Soong config variable which has the same value as the arch by default. In simulator builds we override it the required arch. That way we can avoid this entire go file and we just need to set the quick_code_arch correctly.",
      "parentUuid": "67d867bf_7583e092",
      "revId": "5768d92b5ce174ccccdb1238b4636d00b54039d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9f681284_5e98dded",
        "filename": "build/quick_code_arch.go",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1989777
      },
      "writtenOn": "2024-05-29T08:33:03Z",
      "side": 1,
      "message": "Done\n\nNote: the control of this soong config variable is done in https://android-review.googlesource.com/c/platform/build/+/2679183",
      "parentUuid": "f6be024e_b7715b33",
      "revId": "5768d92b5ce174ccccdb1238b4636d00b54039d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0c1dd255_26b77f52",
        "filename": "build/quick_code_arch.go",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2024-05-29T11:10:12Z",
      "side": 1,
      "message": "Very nice! Much cleaner now.",
      "parentUuid": "9f681284_5e98dded",
      "revId": "5768d92b5ce174ccccdb1238b4636d00b54039d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}