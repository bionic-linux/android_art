{
  "comments": [
    {
      "key": {
        "uuid": "633f9d98_4ef87353",
        "filename": "dexoptanalyzer/dexoptanalyzer.cc",
        "patchSetId": 7
      },
      "lineNbr": 45,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-01-18T12:03:08Z",
      "side": 1,
      "message": "The complexity of dealing with return codes is because you are packing command results into exit status codes that are not naturally suited for the command results. This complexity goes away if you use the standard approach for shell commands: return the error result in the exit code, and the command result in stdout.\n\nI don\u0027t think the costs of parsing the result from stdout justify this added complexity of packing results into the exit status.\n\nDo you have a CL posted for the code that will be executing dexoptanalyzer? Is it installd who is using dexoptanalyzer?\n\nWhat about defining the dexoptanalyzer as a shared library instead of an executable? That would also avoid the need to pack and unpack the dexopt status results. Wouldn\u0027t it be more efficient to avoid a fork/exec?\n\nI assume the reason not to use a shared library is because currently that library would depend on much of art, which is a dependency we don\u0027t want installd to have? If we remove the dependency on creating a runtime instance, would that still be a problem?",
      "range": {
        "startLine": 32,
        "startChar": 0,
        "endLine": 45,
        "endChar": 45
      },
      "revId": "f9f2f46ad6148521070fba61d489b16815b80b79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "633f9d98_8e37bb4f",
        "filename": "dexoptanalyzer/dexoptanalyzer.cc",
        "patchSetId": 7
      },
      "lineNbr": 89,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-01-18T12:03:08Z",
      "side": 1,
      "message": "What do you think about calling this \"--profile-changed\" instead? It\u0027s shorter that way.",
      "range": {
        "startLine": 89,
        "startChar": 16,
        "endLine": 89,
        "endChar": 40
      },
      "revId": "f9f2f46ad6148521070fba61d489b16815b80b79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "633f9d98_ce31c35b",
        "filename": "dexoptanalyzer/dexoptanalyzer.cc",
        "patchSetId": 7
      },
      "lineNbr": 97,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-01-18T12:03:08Z",
      "side": 1,
      "message": "extra \u0027.\u0027?",
      "range": {
        "startLine": 97,
        "startChar": 45,
        "endLine": 97,
        "endChar": 46
      },
      "revId": "f9f2f46ad6148521070fba61d489b16815b80b79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "633f9d98_8eaedb41",
        "filename": "dexoptanalyzer/dexoptanalyzer.cc",
        "patchSetId": 7
      },
      "lineNbr": 184,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-01-18T12:03:08Z",
      "side": 1,
      "message": "\"relocate\" \u003d\u003e \"relocate the boot image\"",
      "range": {
        "startLine": 183,
        "startChar": 0,
        "endLine": 184,
        "endChar": 42
      },
      "revId": "f9f2f46ad6148521070fba61d489b16815b80b79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "633f9d98_aeb397aa",
        "filename": "dexoptanalyzer/dexoptanalyzer.cc",
        "patchSetId": 7
      },
      "lineNbr": 203,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-01-18T12:03:08Z",
      "side": 1,
      "message": "Please file a bug stating that dexoptanalyzer (via oat file assistant) should not need to create a runtime, and that we should refactor the (oat file assistant) code so that we don\u0027t ever pay the large performance cost of creating a runtime for dexoptanalyzer. You can assign the bug to me if you like. Put the bug number in the comment.",
      "range": {
        "startLine": 199,
        "startChar": 0,
        "endLine": 203,
        "endChar": 5
      },
      "revId": "f9f2f46ad6148521070fba61d489b16815b80b79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "633f9d98_aedab7ca",
        "filename": "dexoptanalyzer/dexoptanalyzer.cc",
        "patchSetId": 7
      },
      "lineNbr": 212,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-01-18T12:03:08Z",
      "side": 1,
      "message": "Why should this check be in the OatFileAssistant and where in the OatFileAssistant would you put it? Does it matter what the result of dexoptanalyzer is for dex files on the boot class path?",
      "range": {
        "startLine": 209,
        "startChar": 0,
        "endLine": 212,
        "endChar": 5
      },
      "revId": "f9f2f46ad6148521070fba61d489b16815b80b79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "633f9d98_0eeaeb5b",
        "filename": "dexoptanalyzer/dexoptanalyzer.cc",
        "patchSetId": 7
      },
      "lineNbr": 229,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-01-18T12:03:08Z",
      "side": 1,
      "message": "How do you distinguish between the EXIT_FAILURE code and potential valid dexopt status codes?",
      "range": {
        "startLine": 229,
        "startChar": 53,
        "endLine": 229,
        "endChar": 77
      },
      "revId": "f9f2f46ad6148521070fba61d489b16815b80b79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "633f9d98_4ee4f38b",
        "filename": "dexoptanalyzer/dexoptanalyzer_test.cc",
        "patchSetId": 7
      },
      "lineNbr": 27,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-01-18T12:03:08Z",
      "side": 1,
      "message": "I do not like having such a tight coupling between the DexoptAnalyzerTest and OatFileAssistantTest.\n\nCan you copy-paste just what you need for the DexoptAnalyzerTest instead? Or, would it be too weird to test dexoptanalyzer in the existing OatFileAssistantTest cases?\n\nIs the presubmit failure of the dexopt analyzer test relevant here? Do you know why the test is failing?",
      "range": {
        "startLine": 27,
        "startChar": 0,
        "endLine": 27,
        "endChar": 54
      },
      "revId": "f9f2f46ad6148521070fba61d489b16815b80b79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "633f9d98_8e7c1bd6",
        "filename": "runtime/utils.h",
        "patchSetId": 7
      },
      "lineNbr": 156,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-01-18T12:03:08Z",
      "side": 1,
      "message": "Return char* so you can return NULL in case of error, which is harder to accidentally ignore than the empty string?",
      "range": {
        "startLine": 156,
        "startChar": 0,
        "endLine": 156,
        "endChar": 11
      },
      "revId": "f9f2f46ad6148521070fba61d489b16815b80b79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c3820982_212c0efe",
        "filename": "runtime/utils.h",
        "patchSetId": 7
      },
      "lineNbr": 156,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-01-18T12:03:08Z",
      "side": 1,
      "message": "Is dexoptanalyzer the only user of this? Has there been a notion of a default boot image location before this?\n\nIf not, why introduce a default boot image location now?",
      "range": {
        "startLine": 154,
        "startChar": 0,
        "endLine": 156,
        "endChar": 64
      },
      "revId": "f9f2f46ad6148521070fba61d489b16815b80b79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}