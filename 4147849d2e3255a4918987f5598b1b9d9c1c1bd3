{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "28d92103_91e1c1cc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1989777
      },
      "writtenOn": "2024-10-23T14:37:06Z",
      "side": 1,
      "message": "I\u0027ve applied the fix suggested by @vmarko@google.com ([link](https://android-review.googlesource.com/c/platform/art/+/2680020/comment/7ad844e1_d40ac925/)) however I was unable to reproduce the issue locally, the tests in the commit message pass both with/without the change.\n\nCould you either provide further details on the test/build that failed so I can reproduce or run the test/build on your side to verify the fix works?",
      "revId": "4147849d2e3255a4918987f5598b1b9d9c1c1bd3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "67dce36c_f9d11515",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1894735
      },
      "writtenOn": "2024-10-24T08:47:58Z",
      "side": 1,
      "message": "Thanks Chris! I think that should fix it. I triggered a test run with this CL to verify it is indeed fixed. I will update when I get the results. Typically should finish in a couple of hours.",
      "parentUuid": "28d92103_91e1c1cc",
      "revId": "4147849d2e3255a4918987f5598b1b9d9c1c1bd3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "930cbb76_0abff787",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2024-10-24T12:31:18Z",
      "side": 1,
      "message": "Next time, please create the revert in gerrit and then download-edit-upload. It creates a record on the CL you\u0027re reverting and it also makes the code review easier as I can compare the PS1 with the fixed PS\u003cn\u003e. If you don\u0027t, I need to download the different CLs and review the `git diff` in a terminal.",
      "revId": "4147849d2e3255a4918987f5598b1b9d9c1c1bd3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "81e11e59_dbe3fc4c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1989777
      },
      "writtenOn": "2024-10-30T12:50:53Z",
      "side": 1,
      "message": "Sorry about that, I\u0027ll keep this in mind for next time.",
      "parentUuid": "930cbb76_0abff787",
      "revId": "4147849d2e3255a4918987f5598b1b9d9c1c1bd3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2bb7f875_40ab4252",
        "filename": "runtime/arch/riscv64/jni_entrypoints_riscv64.S",
        "patchSetId": 1
      },
      "lineNbr": 72,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2024-10-24T12:31:18Z",
      "side": 1,
      "message": "This is a JAL instruction with +/-1MiB but the error message actually complained about \"relocation R_RISCV_JAL out of range: -1396552\". I\u0027m not sure if the assembler or linker can automatically replace it with the two-instruction sequence, or if we need to explicitly use the TAIL pseudo-instruction.\n\n(Note that the assembler or linker must have previously replaced the BNEZ with BEQZ+JAL to generate the error message, so I\u0027m not really sure about the toolchain capabilities here.)",
      "range": {
        "startLine": 72,
        "startChar": 4,
        "endLine": 72,
        "endChar": 5
      },
      "revId": "4147849d2e3255a4918987f5598b1b9d9c1c1bd3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4809817d_c94a93cf",
        "filename": "runtime/arch/riscv64/jni_entrypoints_riscv64.S",
        "patchSetId": 1
      },
      "lineNbr": 72,
      "author": {
        "id": 1894735
      },
      "writtenOn": "2024-10-25T11:29:14Z",
      "side": 1,
      "message": "The run with this CL also failed with the same error. As Vladimir said I think the toolchain already replaced bnez with beqz and a jump. Error:\n```\nld.lld: error: out/soong/.intermediates/art/test/libart-gtest/android_riscv64_static_lto-none/libart-gtest.a(jni_entrypoints_riscv64.o):(.text+0x8): relocation R_RISCV_JAL out of range: -1394888 is not in [-1048576, 1048575]; references \u0027art_jni_dlsym_lookup_stub\u0027\n\u003e\u003e\u003e referenced by jni_entrypoints_riscv64.S:71 (art/runtime/arch/riscv64/jni_entrypoints_riscv64.S:71)\n\u003e\u003e\u003e defined in out/soong/.intermediates/art/test/libart-gtest/android_riscv64_static_lto-none/libart-gtest.a(native_entrypoints_riscv64.o)\nclang++: error: linker command failed with exit code 1 (use -v to see invocation)\n``` \n\nTo reproduce this locally, you need the full android checkout (not the smaller one with just art). On the full tree do: \n```\n. build/envsetup.sh\nlunch aosp_riscv64-trunk_staging-eng\nm general-tests\n```\nIf you have any problem reproducing, let me know.",
      "parentUuid": "2bb7f875_40ab4252",
      "range": {
        "startLine": 72,
        "startChar": 4,
        "endLine": 72,
        "endChar": 5
      },
      "revId": "4147849d2e3255a4918987f5598b1b9d9c1c1bd3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3350db96_f23318f2",
        "filename": "runtime/arch/riscv64/jni_entrypoints_riscv64.S",
        "patchSetId": 1
      },
      "lineNbr": 72,
      "author": {
        "id": 1989777
      },
      "writtenOn": "2024-10-30T12:50:53Z",
      "side": 1,
      "message": "Good point, I had missed that this had already been replaced by BEQZ+JAL and that was out of range. I have now replaced this with a tail call as that should guarantee the call is in range.\n\nI tried to reproduce this locally but couldn\u0027t as `libart-gtest.a` links correctly using the instructions above (thanks for providing those!). I wonder if it could be due to some peculiarity with the machine or specific setup that I don\u0027t have locally. Regardless it might be easier if you can verify this change on your side if you can reproduce this.",
      "parentUuid": "2bb7f875_40ab4252",
      "range": {
        "startLine": 72,
        "startChar": 4,
        "endLine": 72,
        "endChar": 5
      },
      "revId": "4147849d2e3255a4918987f5598b1b9d9c1c1bd3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}