{
  "comments": [
    {
      "key": {
        "uuid": "36c12e1a_6d5335c0",
        "filename": "compiler/optimizing/code_generator_x86.cc",
        "patchSetId": 14
      },
      "lineNbr": 2102,
      "author": {
        "id": 1022530
      },
      "writtenOn": "2015-11-03T22:22:48Z",
      "side": 1,
      "message": "Ritz EAAC seems to crash on x86 for me.\n\nIt seems that the XMM7 gets clobbered occasionally in the read barrier slow path below and this hidden arg value won\u0027t be preserved for the subsequent call, because XMM7 isn\u0027t in the fp param register list. If I locally move this hidden arg loading code (lines 2101-2104) conditionally for the (kForceReadBarrier || kUseReadBarrier) case (and using temp3) to line 2125, it seems to go away.\n\nThe crash does not occur on x86_64 probably because the hidden arg RAX gets loaded after the read barrier slow path.\n\nAs this read barrier code here is planned to be removed, it may not matter now, however.",
      "range": {
        "startLine": 2102,
        "startChar": 12,
        "endLine": 2102,
        "endChar": 16
      },
      "revId": "9b982391c5d4a60e7e4d458d561f51c0927ffd0d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "763d66ed_9f3153e9",
        "filename": "compiler/optimizing/code_generator_x86.cc",
        "patchSetId": 14
      },
      "lineNbr": 2102,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2015-11-04T15:00:57Z",
      "side": 1,
      "message": "Thanks for reporting this!  Indeed, I had moved this code (loading the hidden argument) in PS4 on x86-64 after the read barrier because the register where the hidden argument was loaded (RAX on x86-64) was clobbered by the read barrier slow path.\n\nI did not think this issue could happen with XMM7 on x86, so I did not move that code for this target.  This is fixed in PS15.",
      "parentUuid": "36c12e1a_6d5335c0",
      "range": {
        "startLine": 2102,
        "startChar": 12,
        "endLine": 2102,
        "endChar": 16
      },
      "revId": "9b982391c5d4a60e7e4d458d561f51c0927ffd0d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}