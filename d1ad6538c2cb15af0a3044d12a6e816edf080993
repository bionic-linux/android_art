{
  "comments": [
    {
      "key": {
        "uuid": "f72054e0_a8385b84",
        "filename": "runtime/debugger.cc",
        "patchSetId": 4
      },
      "lineNbr": 3426,
      "author": {
        "id": 1015378
      },
      "writtenOn": "2015-03-06T18:07:25Z",
      "side": 1,
      "message": "Unfortunately, I don\u0027t think new returns null if OOM, it throws std::bad_alloc",
      "range": {
        "startLine": 3426,
        "startChar": 6,
        "endLine": 3426,
        "endChar": 25
      },
      "revId": "d1ad6538c2cb15af0a3044d12a6e816edf080993",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "97155885_255ace5c",
        "filename": "runtime/debugger.cc",
        "patchSetId": 4
      },
      "lineNbr": 3426,
      "author": {
        "id": 1029223
      },
      "writtenOn": "2015-03-06T18:28:51Z",
      "side": 1,
      "message": "Right. So the CHECK does not work either I guess. \n\nWhat\u0027s about using \"new (std::nothrow)\"? From the spec, it returns nullptr instead of std::bad_alloc. There are other places where we CHECK allocation succeeds.",
      "parentUuid": "f72054e0_a8385b84",
      "range": {
        "startLine": 3426,
        "startChar": 6,
        "endLine": 3426,
        "endChar": 25
      },
      "revId": "d1ad6538c2cb15af0a3044d12a6e816edf080993",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "17b888d3_1ce7f930",
        "filename": "runtime/debugger.cc",
        "patchSetId": 4
      },
      "lineNbr": 3426,
      "author": {
        "id": 1003723
      },
      "writtenOn": "2015-03-06T20:57:30Z",
      "side": 1,
      "message": "throwing std::bad_alloc is new behavior so some of the old CHECK\u0027s are out of date.",
      "parentUuid": "97155885_255ace5c",
      "range": {
        "startLine": 3426,
        "startChar": 6,
        "endLine": 3426,
        "endChar": 25
      },
      "revId": "d1ad6538c2cb15af0a3044d12a6e816edf080993",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "97155885_c5013ab9",
        "filename": "runtime/debugger.cc",
        "patchSetId": 4
      },
      "lineNbr": 3426,
      "author": {
        "id": 1029223
      },
      "writtenOn": "2015-03-09T08:53:02Z",
      "side": 1,
      "message": "Agreed. In my next PS, I use \"new (std::nothrow)\" to ensure a null pointer is returned if the allocation fails. \n\nWe should do a large pass on all allocations made in ART using \"new\" that may throw a std::bad_alloc instead of returning a nullptr.",
      "parentUuid": "17b888d3_1ce7f930",
      "range": {
        "startLine": 3426,
        "startChar": 6,
        "endLine": 3426,
        "endChar": 25
      },
      "revId": "d1ad6538c2cb15af0a3044d12a6e816edf080993",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f72054e0_c85dcfc6",
        "filename": "runtime/thread.h",
        "patchSetId": 4
      },
      "lineNbr": 1045,
      "author": {
        "id": 1015378
      },
      "writtenOn": "2015-03-06T18:07:25Z",
      "side": 1,
      "message": "Doesn\u0027t adding this field mean you need to update the constants in asm_support.h?",
      "range": {
        "startLine": 1045,
        "startChar": 13,
        "endLine": 1045,
        "endChar": 35
      },
      "revId": "d1ad6538c2cb15af0a3044d12a6e816edf080993",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "57f6809e_2bb8d95e",
        "filename": "runtime/thread.h",
        "patchSetId": 4
      },
      "lineNbr": 1045,
      "author": {
        "id": 1029223
      },
      "writtenOn": "2015-03-06T18:28:51Z",
      "side": 1,
      "message": "That was required when I started this CL. But it was no longer needed after https://android-review.googlesource.com/136081 which removed the is_exception_reported_to_instrumentation_.",
      "parentUuid": "f72054e0_c85dcfc6",
      "range": {
        "startLine": 1045,
        "startChar": 13,
        "endLine": 1045,
        "endChar": 35
      },
      "revId": "d1ad6538c2cb15af0a3044d12a6e816edf080993",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "570f6078_c34db694",
        "filename": "runtime/thread.h",
        "patchSetId": 4
      },
      "lineNbr": 1045,
      "author": {
        "id": 1015378
      },
      "writtenOn": "2015-03-06T18:33:03Z",
      "side": 1,
      "message": "Ah, so there was a padding field then? I guess that makes sense.",
      "parentUuid": "57f6809e_2bb8d95e",
      "range": {
        "startLine": 1045,
        "startChar": 13,
        "endLine": 1045,
        "endChar": 35
      },
      "revId": "d1ad6538c2cb15af0a3044d12a6e816edf080993",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}