{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "0ceb7e21_f6283160",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 12
      },
      "lineNbr": 0,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-09-20T16:50:24Z",
      "side": 1,
      "message": "Thanks Roland for forwarding this CL. Please include me as reviewer for future CLs that involve build changes like this.",
      "revId": "d8d911d950825191986197c8dc9fedd76c351baa",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "79533b94_978d22e4",
        "filename": "compiler/Android.bp",
        "patchSetId": 12
      },
      "lineNbr": 179,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-09-20T16:50:24Z",
      "side": 1,
      "message": "The customary extension is `.map.txt` for these files. Should it be different here?",
      "range": {
        "startLine": 179,
        "startChar": 36,
        "endLine": 179,
        "endChar": 40
      },
      "revId": "d8d911d950825191986197c8dc9fedd76c351baa",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ddb4bdef_d51ab355",
        "filename": "compiler/Android.bp",
        "patchSetId": 12
      },
      "lineNbr": 232,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-09-20T16:50:24Z",
      "side": 1,
      "message": "The purpose of this being a `whole_static_libs` is that it exports all its symbols to libs that depend on libart-compiler. With the version script that becomes pointless unless those symbols are exported there.\n\nCan this dependency be removed here altogether? If not, isn\u0027t it better to export those symbols to avoid linking it repeatedly? It doesn\u0027t appear to be that many symbols in this library.",
      "range": {
        "startLine": 232,
        "startChar": 4,
        "endLine": 232,
        "endChar": 38
      },
      "revId": "d8d911d950825191986197c8dc9fedd76c351baa",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "03f6b6ab_08456da4",
        "filename": "compiler/Android.bp",
        "patchSetId": 12
      },
      "lineNbr": 522,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-09-20T16:50:24Z",
      "side": 1,
      "message": "+rpl This means we won\u0027t test the code actually in the APEX module. If everything is working correctly the test comes from the same build as the module, so it doesn\u0027t matter. However in practice we\u0027ve seen problems in that area, and with tests that basically test themselves rather than the module that can make us blind to regressions.\n\nHow many extra symbols would be required to avoid this? (Not just in this gtest, but all of them.)\n\nIf we are to go this way with statically linked libraries, we need to ensure that the tests correspond to the module. One way to do that could be to add a test that compares the build id between the test and the module. It\u0027s not obvious how we\u0027d construct that build id to make it work correctly though (the ART module version is too coarse, and the platform build id won\u0027t work for unbundled modules).\n\nAnother problem is ODR violations: There\u0027s plenty of global state in this library, and the test could potentially end up with multiple copies of that if it has this static copy in addition to the .so file being loaded indirectly through other libraries. Apparently the tests don\u0027t break atm, but it\u0027s brittle, so this would need a safeguard of some sort.",
      "range": {
        "startLine": 522,
        "startChar": 7,
        "endLine": 522,
        "endChar": 26
      },
      "revId": "d8d911d950825191986197c8dc9fedd76c351baa",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d64b67ee_166acdb3",
        "filename": "compiler/Android.bp",
        "patchSetId": 12
      },
      "lineNbr": 522,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2022-09-20T17:24:28Z",
      "side": 1,
      "message": "Yeah, I was planning on following up with you / Dmitrii / Roland on this. On the statically linking we know the situation is brittle anyway as any symbol change can break the tests if we run MTS and ART versions that don\u0027t match. And the solution to that is to make sure that MTS and ART versions always match, which statically linking also achieves.",
      "parentUuid": "03f6b6ab_08456da4",
      "range": {
        "startLine": 522,
        "startChar": 7,
        "endLine": 522,
        "endChar": 26
      },
      "revId": "d8d911d950825191986197c8dc9fedd76c351baa",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f89e987b_ff793aa4",
        "filename": "compiler/libart-compiler.map",
        "patchSetId": 12
      },
      "lineNbr": 1,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-09-20T16:50:24Z",
      "side": 1,
      "message": "Please add copyright blurb.",
      "revId": "d8d911d950825191986197c8dc9fedd76c351baa",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "59996fe0_d857b117",
        "filename": "compiler/libart-compiler.map",
        "patchSetId": 12
      },
      "lineNbr": 47,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-09-20T16:50:24Z",
      "side": 1,
      "message": "Nit: Extra empty line.",
      "revId": "d8d911d950825191986197c8dc9fedd76c351baa",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}