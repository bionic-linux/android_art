{
  "comments": [
    {
      "key": {
        "uuid": "300cbaed_95eec133",
        "filename": "compiler/elf_builder.h",
        "patchSetId": 1
      },
      "lineNbr": 152,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2015-05-01T01:47:23Z",
      "side": 1,
      "message": "I think the standard style would suffix with Fn or something like that to make clear it\u0027s a function pointer type.",
      "range": {
        "startLine": 152,
        "startChar": 8,
        "endLine": 152,
        "endChar": 13
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b0598aea_0ec1cf2d",
        "filename": "compiler/elf_builder.h",
        "patchSetId": 1
      },
      "lineNbr": 152,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2015-05-01T09:34:00Z",
      "side": 1,
      "message": "This interface does not allow the function to range-check. It should be \"std::vector\u003cuint8_t\u003e* buffer\" (or \"ArrayRef\u003cuint8_t\u003e buffer\" but let\u0027s keep this consistent with the rest of the file).",
      "range": {
        "startLine": 152,
        "startChar": 25,
        "endLine": 152,
        "endChar": 40
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "507cce56_a231fe1f",
        "filename": "compiler/elf_builder.h",
        "patchSetId": 1
      },
      "lineNbr": 152,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2015-05-01T14:50:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b0598aea_0ec1cf2d",
      "range": {
        "startLine": 152,
        "startChar": 25,
        "endLine": 152,
        "endChar": 40
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "70f8f2fa_f6bd8f45",
        "filename": "compiler/elf_builder.h",
        "patchSetId": 1
      },
      "lineNbr": 204,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2015-05-01T01:47:23Z",
      "side": 1,
      "message": "Please use a better name and document this so I don\u0027t have to look at how it\u0027s used. Maybe patched_against_section_? patch_base_ wasn\u0027t bad in that respect.",
      "range": {
        "startLine": 204,
        "startChar": 19,
        "endLine": 204,
        "endChar": 33
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "70bf1233_2371aada",
        "filename": "compiler/elf_builder.h",
        "patchSetId": 1
      },
      "lineNbr": 204,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2015-05-01T14:50:20Z",
      "side": 1,
      "message": "Done (patch_base_section_ + comment)",
      "parentUuid": "70f8f2fa_f6bd8f45",
      "range": {
        "startLine": 204,
        "startChar": 19,
        "endLine": 204,
        "endChar": 33
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "300cbaed_a642c11a",
        "filename": "compiler/elf_writer_debug.cc",
        "patchSetId": 1
      },
      "lineNbr": 190,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2015-04-30T22:30:07Z",
      "side": 1,
      "message": "This has to change now. Here\u0027s the part that leads to linear_search in the code of libunwind:\n\n if (hdr-\u003etable_enc !\u003d (DW_EH_PE_datarel | DW_EH_PE_sdata4)) {\n   ... ; linear_search ; ...\n }",
      "range": {
        "startLine": 189,
        "startChar": 2,
        "endLine": 190,
        "endChar": 76
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b0598aea_ceae5799",
        "filename": "compiler/elf_writer_debug.cc",
        "patchSetId": 1
      },
      "lineNbr": 196,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2015-04-30T23:08:55Z",
      "side": 1,
      "message": "Isn\u0027t this the hdr-\u003etable_enc?",
      "range": {
        "startLine": 196,
        "startChar": 19,
        "endLine": 196,
        "endChar": 53
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "70f8f2fa_a2b0e6bb",
        "filename": "compiler/elf_writer_debug.cc",
        "patchSetId": 1
      },
      "lineNbr": 196,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2015-05-01T00:08:51Z",
      "side": 1,
      "message": "Ups, you\u0027re right.",
      "parentUuid": "b0598aea_ceae5799",
      "range": {
        "startLine": 196,
        "startChar": 19,
        "endLine": 196,
        "endChar": 53
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "705392ca_0c7b1bbb",
        "filename": "compiler/elf_writer_debug.cc",
        "patchSetId": 1
      },
      "lineNbr": 206,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2015-05-01T09:34:00Z",
      "side": 1,
      "message": "Either add the patch location to the code address here, or subtract the location from initial_address in WriteEhFrameFDE().\n\nSee my comment about SubtractLocation in elf_writer_quick.cc .",
      "range": {
        "startLine": 206,
        "startChar": 22,
        "endLine": 206,
        "endChar": 34
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "300cbaed_f5aa9c7d",
        "filename": "compiler/elf_writer_debug.cc",
        "patchSetId": 1
      },
      "lineNbr": 207,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2015-05-01T01:47:23Z",
      "side": 1,
      "message": "Put into a variable before the loop?",
      "range": {
        "startLine": 207,
        "startChar": 21,
        "endLine": 207,
        "endChar": 60
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "300cbaed_9571a08e",
        "filename": "compiler/elf_writer_debug.cc",
        "patchSetId": 1
      },
      "lineNbr": 207,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2015-05-01T01:47:23Z",
      "side": 1,
      "message": "Can you add a comment here saying that we know the exact layout (eh_frame immediately before eh_frame_hdr) and the data is relative to the start of the eh_frame_hdr, so patching isn\u0027t necessary. (In contrast to the PC)",
      "range": {
        "startLine": 207,
        "startChar": 4,
        "endLine": 207,
        "endChar": 76
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "70bf1233_83ee9eb6",
        "filename": "compiler/elf_writer_debug.cc",
        "patchSetId": 1
      },
      "lineNbr": 207,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2015-05-01T14:50:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "300cbaed_f5aa9c7d",
      "range": {
        "startLine": 207,
        "startChar": 21,
        "endLine": 207,
        "endChar": 60
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "70f8f2fa_96124bd8",
        "filename": "compiler/elf_writer_quick.cc",
        "patchSetId": 1
      },
      "lineNbr": 111,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2015-05-01T01:47:23Z",
      "side": 1,
      "message": "We treat those like constants, so they\u0027re often named like kSubtractMyAddr in the runtime. Also, lately we\u0027re avoiding booleans for readability at the call-site, instead introducing enums...\n\nAlternatively you could consider introducing minimal wrappers that have self-explaining names, e.g., PatchMakeRelative or so (though I don\u0027t know good names for all combinations).",
      "range": {
        "startLine": 111,
        "startChar": 15,
        "endLine": 111,
        "endChar": 29
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "70bf1233_a3ae3a97",
        "filename": "compiler/elf_writer_quick.cc",
        "patchSetId": 1
      },
      "lineNbr": 111,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2015-05-01T14:50:20Z",
      "side": 1,
      "message": "I have combined the two bools into single enum.",
      "parentUuid": "70f8f2fa_96124bd8",
      "range": {
        "startLine": 111,
        "startChar": 15,
        "endLine": 111,
        "endChar": 29
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "90fd66eb_91dedc05",
        "filename": "compiler/elf_writer_quick.cc",
        "patchSetId": 1
      },
      "lineNbr": 113,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2015-05-01T01:47:23Z",
      "side": 1,
      "message": "Maybe base_address (or base_section_address) is a better name? \"my\" isn\u0027t really expressive.",
      "range": {
        "startLine": 113,
        "startChar": 27,
        "endLine": 113,
        "endChar": 29
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7011d208_13330ca3",
        "filename": "compiler/elf_writer_quick.cc",
        "patchSetId": 1
      },
      "lineNbr": 113,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2015-05-01T09:34:00Z",
      "side": 1,
      "message": "my_address -\u003e buffer_address, other_address -\u003e base_address",
      "parentUuid": "90fd66eb_91dedc05",
      "range": {
        "startLine": 113,
        "startChar": 27,
        "endLine": 113,
        "endChar": 29
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "90c486d3_a443e273",
        "filename": "compiler/elf_writer_quick.cc",
        "patchSetId": 1
      },
      "lineNbr": 113,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2015-05-01T14:50:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7011d208_13330ca3",
      "range": {
        "startLine": 113,
        "startChar": 27,
        "endLine": 113,
        "endChar": 29
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7011d208_b36cd889",
        "filename": "compiler/elf_writer_quick.cc",
        "patchSetId": 1
      },
      "lineNbr": 118,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2015-05-01T09:34:00Z",
      "side": 1,
      "message": "I think the SubtractLocation is unnecessary, considering that we are now adding to *to_patch rather than assigning. We should either choose to subtract location together with my_address if SubtractMyAddress (as it\u0027s been done previously), or don\u0027t subtract it at all. In both cases we can prepare the original buffer so that this yields the correct result.",
      "range": {
        "startLine": 118,
        "startChar": 31,
        "endLine": 118,
        "endChar": 66
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "507cce56_62ad3696",
        "filename": "compiler/elf_writer_quick.cc",
        "patchSetId": 1
      },
      "lineNbr": 118,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2015-05-01T14:50:20Z",
      "side": 1,
      "message": "I known what you mean, I have briefly considered it as well.  However, I have decided that I would rather have the extra complexity here than doing half of the calculation here and half in WriteEhFrame.\n\nThe intention is that the unpatched address is just \"method_info-\u003elow_pc_\" in all cases, and the patch method transforms it to its final form - whatever that might be.",
      "parentUuid": "7011d208_b36cd889",
      "range": {
        "startLine": 118,
        "startChar": 31,
        "endLine": 118,
        "endChar": 66
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "90fd66eb_11c3ec3d",
        "filename": "compiler/elf_writer_quick.cc",
        "patchSetId": 1
      },
      "lineNbr": 148,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2015-05-01T01:47:23Z",
      "side": 1,
      "message": "Period.",
      "range": {
        "startLine": 148,
        "startChar": 85,
        "endLine": 148,
        "endChar": 86
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "70f8f2fa_596c7405",
        "filename": "compiler/elf_writer_quick.cc",
        "patchSetId": 1
      },
      "lineNbr": 149,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2015-05-01T01:47:23Z",
      "side": 1,
      "message": "I don\u0027t know whether I really see all patches, but it looks like eh_frame doesn\u0027t have that many? (In fact, I only see one.) So maybe we could avoid this parameter?",
      "range": {
        "startLine": 149,
        "startChar": 64,
        "endLine": 149,
        "endChar": 68
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "90c486d3_e43ddae1",
        "filename": "compiler/elf_writer_quick.cc",
        "patchSetId": 1
      },
      "lineNbr": 149,
      "author": {
        "id": 1065473
      },
      "writtenOn": "2015-05-01T14:50:20Z",
      "side": 1,
      "message": "eh_frame should have one patch location per method - so quite a few...\nsame for eh_frame_hdr",
      "parentUuid": "70f8f2fa_596c7405",
      "range": {
        "startLine": 149,
        "startChar": 64,
        "endLine": 149,
        "endChar": 68
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "90fd66eb_f1c76045",
        "filename": "compiler/elf_writer_quick.cc",
        "patchSetId": 1
      },
      "lineNbr": 154,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2015-05-01T01:47:23Z",
      "side": 1,
      "message": "Period.",
      "range": {
        "startLine": 154,
        "startChar": 76,
        "endLine": 154,
        "endChar": 77
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "300cbaed_b5294486",
        "filename": "compiler/elf_writer_quick.cc",
        "patchSetId": 1
      },
      "lineNbr": 155,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2015-05-01T01:47:23Z",
      "side": 1,
      "message": "Could omit this one, but in general I\u0027d prefer to be expressive here and below to distinguish the different patching modes (different wrapper functions would be nice and intention-revealing here, but I don\u0027t know good names for all of \u0027em, see above).",
      "range": {
        "startLine": 155,
        "startChar": 56,
        "endLine": 155,
        "endChar": 63
      },
      "revId": "d8dcecf79f9ff038b47846bd41cc51a64b548ced",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}