{
  "comments": [
    {
      "key": {
        "uuid": "6c3f3382_d95add82",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1071150
      },
      "writtenOn": "2020-08-07T13:24:41Z",
      "side": 1,
      "message": "LGTM, but really needs tests to ensure we don\u0027t inadvertently break this later.",
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a381d17f_bbc7d72c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2020-09-03T13:29:43Z",
      "side": 1,
      "message": "Calin, are you OK with the change?",
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e799acb3_0c44b12e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2020-09-04T02:54:35Z",
      "side": 1,
      "message": "Sorry I didn\u0027t have a chance to take another look. Will do it on Tuesday.",
      "parentUuid": "a381d17f_bbc7d72c",
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f7143ce3_f3b9b444",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2020-09-10T08:59:44Z",
      "side": 1,
      "message": "Calin, ping again ðŸ˜Š",
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "68e47654_d0371827",
        "filename": "dex2oat/dex2oat.cc",
        "patchSetId": 1
      },
      "lineNbr": 1995,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2020-08-27T01:22:48Z",
      "side": 1,
      "message": "I assume we documented that some of these fds can be kInvalidFd.",
      "range": {
        "startLine": 1995,
        "startChar": 13,
        "endLine": 1995,
        "endChar": 42
      },
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1c565261_41909f6f",
        "filename": "dex2oat/dex2oat.cc",
        "patchSetId": 1
      },
      "lineNbr": 1995,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2020-08-27T13:39:20Z",
      "side": 1,
      "message": "Only the image fd right?",
      "parentUuid": "68e47654_d0371827",
      "range": {
        "startLine": 1995,
        "startChar": 13,
        "endLine": 1995,
        "endChar": 42
      },
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2c62f075_f3d4873b",
        "filename": "dex2oat/dex2oat.cc",
        "patchSetId": 1
      },
      "lineNbr": 1995,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2020-08-27T18:36:33Z",
      "side": 1,
      "message": "yep.",
      "parentUuid": "1c565261_41909f6f",
      "range": {
        "startLine": 1995,
        "startChar": 13,
        "endLine": 1995,
        "endChar": 42
      },
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ad224444_e6424bd3",
        "filename": "runtime/class_linker.cc",
        "patchSetId": 1
      },
      "lineNbr": 4182,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2020-08-27T01:22:48Z",
      "side": 1,
      "message": "Is it expected that we pass the  dex location or the file path? they might not be same and many times I think they are still not the same. (also this will end up reporting once per dex file if there\u0027s a multi dex apk)",
      "range": {
        "startLine": 4182,
        "startChar": 31,
        "endLine": 4182,
        "endChar": 53
      },
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "69e30f6f_933c22aa",
        "filename": "runtime/class_linker.cc",
        "patchSetId": 1
      },
      "lineNbr": 4182,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2020-08-27T13:39:20Z",
      "side": 1,
      "message": "The intention is to send the actual file path on device. Is GetLocation the right thing to pass?",
      "parentUuid": "ad224444_e6424bd3",
      "range": {
        "startLine": 4182,
        "startChar": 31,
        "endLine": 4182,
        "endChar": 53
      },
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "43a19fa0_1f056a76",
        "filename": "runtime/class_linker.cc",
        "patchSetId": 1
      },
      "lineNbr": 4182,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2020-08-27T18:36:33Z",
      "side": 1,
      "message": "GetLocation() is not the right thing then. In many cases there\u0027s still a divergences. (Also GetLocation will have the \":classes2.dex\" suffix).\n\nI\u0027m actually not aware of any api which will give the path reliably (we can reconstruct it, I think...). We might need to add a new field to keep track of that to make our life simpler.",
      "parentUuid": "69e30f6f_933c22aa",
      "range": {
        "startLine": 4182,
        "startChar": 31,
        "endLine": 4182,
        "endChar": 53
      },
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "81e9fbe9_b5beb791",
        "filename": "runtime/class_linker.cc",
        "patchSetId": 1
      },
      "lineNbr": 4182,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2020-09-02T14:07:15Z",
      "side": 1,
      "message": "I\u0027ve looked what gets notified on the devices, and it looks sane here (maybe host is an issue?). Having suffixes like :classes2.dex make sense when it\u0027s part of a zip.",
      "parentUuid": "43a19fa0_1f056a76",
      "range": {
        "startLine": 4182,
        "startChar": 31,
        "endLine": 4182,
        "endChar": 53
      },
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b2f246ce_8ddaec2b",
        "filename": "runtime/class_linker.cc",
        "patchSetId": 1
      },
      "lineNbr": 4182,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2020-09-11T04:11:29Z",
      "side": 1,
      "message": "If you checked the device and all looks good we should be allright. \nI always tried to push for real location there but there were some cases when it didn\u0027t work (maybe host...)\n\nI did try to test on a device, but I got boot loop :) So here\u0027s some corner cases for you to check before submit:\n- split apk\n- post OTA\n- post BgDexopt\n- secondary dex files post BgDexopt.",
      "parentUuid": "81e9fbe9_b5beb791",
      "range": {
        "startLine": 4182,
        "startChar": 31,
        "endLine": 4182,
        "endChar": 53
      },
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "59a2df31_d42116b2",
        "filename": "runtime/class_linker.cc",
        "patchSetId": 1
      },
      "lineNbr": 4182,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2020-09-15T15:04:40Z",
      "side": 1,
      "message": "I\u0027ve logged and only saw valid locations - given these all come from installd, I expect OTA and BgDexopt to have same behavior, no?",
      "parentUuid": "b2f246ce_8ddaec2b",
      "range": {
        "startLine": 4182,
        "startChar": 31,
        "endLine": 4182,
        "endChar": 53
      },
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a41da42a_ca80bf63",
        "filename": "runtime/class_linker.cc",
        "patchSetId": 1
      },
      "lineNbr": 4182,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2020-09-16T02:51:13Z",
      "side": 1,
      "message": "They should now, but historically we did have variations.\nI looked at the bg-dexopt case and looks ok.\n\nThe runtime always sees full paths. It\u0027s only dex2oat which temporarily sees relative paths. I added a logging in RegisterDexFiles and for a secondary dex file here\u0027s what I see:\n\n09-15 19:24:02.651 24538 32614 I PackageDexOptimizer: Running dexopt (dexoptNeeded\u003d1) on: /data/app/~~aZmNqKfNunMkMCEemwERmw\u003d\u003d/com.android.chrome-HmAHa6VdVKRBMZ3MUaTJxg\u003d\u003d/split_vr.apk ....\n09-15 19:24:02.764 32728 32728 I dex2oat64: CALIN: split_vr.apk\n\nBut then, the runtime has the full path:\n09-15 19:30:20.667  3603  3603 I .android.chrom: CALIN: /data/app/~~aZmNqKfNunMkMCEemwERmw\u003d\u003d/com.android.chrome-HmAHa6VdVKRBMZ3MUaTJxg\u003d\u003d/split_vr.apk\n\n\n(you might want to add a LOG(VERBOSE), in case there are issues, so that we can easily debug it).",
      "parentUuid": "59a2df31_d42116b2",
      "range": {
        "startLine": 4182,
        "startChar": 31,
        "endLine": 4182,
        "endChar": 53
      },
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9a19a6ad_2a0c787d",
        "filename": "runtime/oat_file_manager.cc",
        "patchSetId": 1
      },
      "lineNbr": 70,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2020-08-27T01:22:48Z",
      "side": 1,
      "message": "same comment as with the dex location.",
      "range": {
        "startLine": 70,
        "startChar": 41,
        "endLine": 70,
        "endChar": 52
      },
      "revId": "b50ea7093ac35c64bb8ed63a4be297a387915b90",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}