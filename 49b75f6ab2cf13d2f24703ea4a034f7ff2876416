{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "5609b877_ddd466ff",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1042828
      },
      "writtenOn": "2021-02-16T05:44:42Z",
      "side": 1,
      "message": "An initial pass at preventing the Zygote native loop code from breaking jit zygote.",
      "revId": "49b75f6ab2cf13d2f24703ea4a034f7ff2876416",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4ca5726b_575b98cb",
        "filename": "runtime/jit/jit.h",
        "patchSetId": 1
      },
      "lineNbr": 404,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2021-02-16T11:12:55Z",
      "side": 1,
      "message": "Zygote always uses JIT compilation. Do we want to disable JIT compilation for our case? Or could we find a mode where only when the JIT queue is not empty, we respawn the JIT thread?",
      "range": {
        "startLine": 403,
        "startChar": 0,
        "endLine": 404,
        "endChar": 33
      },
      "revId": "49b75f6ab2cf13d2f24703ea4a034f7ff2876416",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e53b3475_9641854d",
        "filename": "runtime/jit/jit.h",
        "patchSetId": 1
      },
      "lineNbr": 404,
      "author": {
        "id": 1042828
      },
      "writtenOn": "2021-02-16T16:24:21Z",
      "side": 1,
      "message": "I should have been clearer. The intent here was to initially implement this in a way that effectively disables my CL for jit zygote, but allows it (with a future CL) to be reenabled after JIT compilation is done. My impression was that the future CL is not completely trivial, at least for me, but only because I need to understand the logic here better.\n\nIs there significant benefit to being able to turn this on and off? My optimization tends to be less effective shortly after boot anyway, since that\u0027s when we issue a bunch of odd zygote commands that require fallback to the old path. (For some, that\u0027s probably inherent. For others that could be addressed in the future.)",
      "parentUuid": "4ca5726b_575b98cb",
      "range": {
        "startLine": 403,
        "startChar": 0,
        "endLine": 404,
        "endChar": 33
      },
      "revId": "49b75f6ab2cf13d2f24703ea4a034f7ff2876416",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f9df90f9_bcd4f5af",
        "filename": "runtime/jit/jit.h",
        "patchSetId": 1
      },
      "lineNbr": 404,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2021-02-18T14:00:48Z",
      "side": 1,
      "message": "Discussed offline - as long as if we start executing Java code again in the zygote, and that makes the JIT do its work still, then the approach lgtm. Special casing JIT zygote to not have the optimization also lgtm.",
      "parentUuid": "e53b3475_9641854d",
      "range": {
        "startLine": 403,
        "startChar": 0,
        "endLine": 404,
        "endChar": 33
      },
      "revId": "49b75f6ab2cf13d2f24703ea4a034f7ff2876416",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e55dae35_7186d856",
        "filename": "runtime/jit/jit.h",
        "patchSetId": 1
      },
      "lineNbr": 404,
      "author": {
        "id": 1042828
      },
      "writtenOn": "2021-02-18T16:25:21Z",
      "side": 1,
      "message": "Good. I\u0027ll stick with the current approach for now, and then make sure that we reenable the optimization with JITZygote once it\u0027s done JIT compiling anything that affects other processes.",
      "parentUuid": "f9df90f9_bcd4f5af",
      "range": {
        "startLine": 403,
        "startChar": 0,
        "endLine": 404,
        "endChar": 33
      },
      "revId": "49b75f6ab2cf13d2f24703ea4a034f7ff2876416",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "47f9abd9_dea740dd",
        "filename": "runtime/native/dalvik_system_ZygoteHooks.cc",
        "patchSetId": 1
      },
      "lineNbr": 432,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2021-02-16T11:12:55Z",
      "side": 1,
      "message": "Though there\u0027s a point at which the zygote doesn\u0027t need to JIT anymore - is it worth caring for that case?",
      "range": {
        "startLine": 432,
        "startChar": 2,
        "endLine": 432,
        "endChar": 52
      },
      "revId": "49b75f6ab2cf13d2f24703ea4a034f7ff2876416",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aca46dbf_43195722",
        "filename": "runtime/native/dalvik_system_ZygoteHooks.cc",
        "patchSetId": 1
      },
      "lineNbr": 432,
      "author": {
        "id": 1042828
      },
      "writtenOn": "2021-02-16T16:24:21Z",
      "side": 1,
      "message": "My assumption was that happened relatively soon after boot, and that\u0027s what I was hoping to leverage. I was not planning to switch back and forth.",
      "parentUuid": "47f9abd9_dea740dd",
      "range": {
        "startLine": 432,
        "startChar": 2,
        "endLine": 432,
        "endChar": 52
      },
      "revId": "49b75f6ab2cf13d2f24703ea4a034f7ff2876416",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "99cfbb6c_45b237b0",
        "filename": "runtime/native/dalvik_system_ZygoteHooks.cc",
        "patchSetId": 1
      },
      "lineNbr": 432,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2021-02-18T14:00:48Z",
      "side": 1,
      "message": "\u003e My assumption was that happened relatively soon after boot\n\nAre you asking in the context of JIT zygote? This does take time and will finish ~2 minutes after boot.",
      "parentUuid": "aca46dbf_43195722",
      "range": {
        "startLine": 432,
        "startChar": 2,
        "endLine": 432,
        "endChar": 52
      },
      "revId": "49b75f6ab2cf13d2f24703ea4a034f7ff2876416",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bf09f3e7_f656ff2e",
        "filename": "runtime/native/dalvik_system_ZygoteHooks.cc",
        "patchSetId": 1
      },
      "lineNbr": 432,
      "author": {
        "id": 1042828
      },
      "writtenOn": "2021-02-18T16:25:21Z",
      "side": 1,
      "message": "Yes. I think that\u0027s still well worthwhile, at least in the sense that it should avoid the any long term degradation.",
      "parentUuid": "99cfbb6c_45b237b0",
      "range": {
        "startLine": 432,
        "startChar": 2,
        "endLine": 432,
        "endChar": 52
      },
      "revId": "49b75f6ab2cf13d2f24703ea4a034f7ff2876416",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}