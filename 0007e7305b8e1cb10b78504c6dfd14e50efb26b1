{
  "comments": [
    {
      "key": {
        "uuid": "f86e976b_5a570081",
        "filename": "build/apex/ld.config.txt",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2020-02-19T22:16:00Z",
      "side": 0,
      "message": "I compared the autogenerated file to this, after removing semantically irrelevant bits: http://gpaste/5957037680754688\n\nDifferences are due to more system links, some extra permitted.paths and asan.search.paths, and a few cases of changed namespace lookup order. I think those are fine, but these changes are worth calling out:\n\n-namespace.adbd.visible \u003d true\n-namespace.system.link.art.shared_libs \u003d libicui18n.so\n-namespace.system.link.art.shared_libs \u003d libicuuc.so\n\nVisibility on the adbd namespace I don\u0027t know about, maybe it isn\u0027t necessary.\n\nThe dropped libicu links look wrong though. Kiyoung/Jooyung, what\u0027s the reason for that?",
      "revId": "0007e7305b8e1cb10b78504c6dfd14e50efb26b1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33ff0b6d_de014fb4",
        "filename": "build/apex/ld.config.txt",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1415877
      },
      "writtenOn": "2020-02-20T01:04:02Z",
      "side": 0,
      "message": "adbd\u0027s visibility seems fine.\n\nI guess that kiyoung \"experimented\" with those two missing libs to see if those two are really necessary or not. He commented out those two here:\nhttps://source.corp.google.com/h/android/platform/system/linkerconfig/+/2b465ce8817699ace03770455b931e1b8d20e398:contents/namespace/apexplatform.cc;bpv\u003d1;bpt\u003d0\n\nKiyoung, can you confirm?",
      "parentUuid": "f86e976b_5a570081",
      "revId": "0007e7305b8e1cb10b78504c6dfd14e50efb26b1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ab95b027_ce39d9d4",
        "filename": "build/apex/ld.config.txt",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1413436
      },
      "writtenOn": "2020-02-20T05:39:39Z",
      "side": 0,
      "message": "At that time I removed those because there ART APEX did not listed those files as \u0027provide\u0027.\nIf we can get those from providing libs now, let\u0027s let them back in the list.",
      "parentUuid": "33ff0b6d_de014fb4",
      "revId": "0007e7305b8e1cb10b78504c6dfd14e50efb26b1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b8dcc2ec_d96d2aeb",
        "filename": "build/apex/ld.config.txt",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1413436
      },
      "writtenOn": "2020-02-20T06:01:50Z",
      "side": 0,
      "message": "Seems like they are not on the list because they did not define the stub.\n\nlibicuuc : https://source.corp.google.com/android/external/icu/icu4c/source/common/Android.bp;l\u003d82;cl\u003dmaster?q\u003df:Android.bp%20%22name:%20%5C%22libicuuc%5C%22%22\u0026sq\u003dpackage:android\n\nlibicui18n : \nhttps://source.corp.google.com/android/external/icu/icu4c/source/i18n/Android.bp;l\u003d72;cl\u003dmaster?q\u003df:Android.bp%20%22name:%20%5C%22libicui18n%5C%22%22\u0026sq\u003dpackage:android\n\nCan anyone please confirm IF these libraries are expected to be used from outside of ART APEX or not?",
      "parentUuid": "ab95b027_ce39d9d4",
      "revId": "0007e7305b8e1cb10b78504c6dfd14e50efb26b1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c761631c_572fad16",
        "filename": "build/apex/ld.config.txt",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1415877
      },
      "writtenOn": "2020-02-20T06:23:55Z",
      "side": 0,
      "message": "Yes, they are required to be used from system. I once listed them in apex_manfiest.json manually to remove hard-coded list from art apex, but discarded because art apex is customized and those two libs should be hard-coded in system-default namespace anyway.",
      "parentUuid": "b8dcc2ec_d96d2aeb",
      "revId": "0007e7305b8e1cb10b78504c6dfd14e50efb26b1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "92237db4_11cb80b7",
        "filename": "build/apex/ld.config.txt",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1415877
      },
      "writtenOn": "2020-02-20T06:40:55Z",
      "side": 0,
      "message": "More info about \"provideNativeLibs\" key in apex_manfiest.json https://b.corp.google.com/issues/143733063#comment13\n\nIf we list those two libs in manifest.json manually, then we could eliminate the hard-coded \"AddProvides\" from art namespace. But it is only a one-half. The other side is \"AddRequires\" from system namespace.\n\nIf we decide to make system namespace link to all providing apexes, then we could remove the other half. ;-)",
      "parentUuid": "c761631c_572fad16",
      "revId": "0007e7305b8e1cb10b78504c6dfd14e50efb26b1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0591e8ab_10d55042",
        "filename": "build/apex/ld.config.txt",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2020-02-20T08:36:08Z",
      "side": 0,
      "message": "The files are soon going to move to another apex, so not having to put some hardcoded paths is best here.",
      "parentUuid": "92237db4_11cb80b7",
      "revId": "0007e7305b8e1cb10b78504c6dfd14e50efb26b1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aabfa6f4_3d266cb7",
        "filename": "build/apex/ld.config.txt",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2020-02-20T14:08:34Z",
      "side": 0,
      "message": "The AddRequires from system doesn\u0027t depend on the source APEX, so there are no hardcoded paths in linkerconfig to worry about.\n\n\u003e The other side is \"AddRequires\" from system namespace.\n\nWhere does that go? I thought the AddRequires in linkerconfig like [1] would be used, but even after adding libicu* to the ART manifest I don\u0027t see the links in the generated ART ld.config.txt. On a related note, can the hardcoded AddRequires and AddProvides in art.cc [2] be removed now?\n\n[1] https://source.corp.google.com/h/android/platform/system/linkerconfig/+/2b465ce8817699ace03770455b931e1b8d20e398:contents/namespace/systemdefault.cc;l\u003d115-118;drc\u003d3e690e08dfc55b2199f312b966c37165b272d5de\n[2] http://cs/aosp-master/system/linkerconfig/contents/namespace/art.cc",
      "parentUuid": "0591e8ab_10d55042",
      "revId": "0007e7305b8e1cb10b78504c6dfd14e50efb26b1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}