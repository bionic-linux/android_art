{
  "comments": [
    {
      "key": {
        "uuid": "d9461042_2fb405ba",
        "filename": "runtime/native_bridge.cc",
        "patchSetId": 5
      },
      "lineNbr": 66,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2014-07-23T20:39:10Z",
      "side": 1,
      "message": "This will try over and over to load the library, even when it failed the first time.",
      "range": {
        "startLine": 40,
        "startChar": 2,
        "endLine": 66,
        "endChar": 3
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3931ecd1_87416624",
        "filename": "runtime/native_bridge.cc",
        "patchSetId": 5
      },
      "lineNbr": 66,
      "author": {
        "id": 1050938
      },
      "writtenOn": "2014-07-24T01:49:18Z",
      "side": 1,
      "message": "It is kinda exception if it fails in the first time. Then we will be a little bit slower to handle it by trying to reload native-bridge the next time it was invoked.\n\nAnd we are okay to add a new field init_fail_ to indicate the first time init failure. In that case it returns false directly.",
      "parentUuid": "d9461042_2fb405ba",
      "range": {
        "startLine": 40,
        "startChar": 2,
        "endLine": 66,
        "endChar": 3
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39580c1a_5293b206",
        "filename": "runtime/native_bridge.cc",
        "patchSetId": 5
      },
      "lineNbr": 66,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2014-07-24T03:56:45Z",
      "side": 1,
      "message": "Don\u0027t worry about this one. With the change towards passing the property as a command-line parameter, I\u0027ll put the initialization into Runtime::Init again as in the other CL. Thus there won\u0027t be concurrency issues etc, and the flag will mean whether there\u0027s a native bridge or not...",
      "parentUuid": "3931ecd1_87416624",
      "range": {
        "startLine": 40,
        "startChar": 2,
        "endLine": 66,
        "endChar": 3
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "592ce07a_c86d2f82",
        "filename": "runtime/native_bridge.cc",
        "patchSetId": 5
      },
      "lineNbr": 66,
      "author": {
        "id": 1050938
      },
      "writtenOn": "2014-07-24T04:45:56Z",
      "side": 1,
      "message": "Okay. While we prefer lazily initialization because it saves the memory cost for app that does not need native-bridge. If we initialize native-bridge in Runtime::Init, it will be loaded and initialized for all apps and system servers. While most apps, you know, are with primary ABI.",
      "parentUuid": "39580c1a_5293b206",
      "range": {
        "startLine": 40,
        "startChar": 2,
        "endLine": 66,
        "endChar": 3
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1926e89c_e6ff7e40",
        "filename": "runtime/native_bridge.cc",
        "patchSetId": 5
      },
      "lineNbr": 66,
      "author": {
        "id": 1050938
      },
      "writtenOn": "2014-07-24T04:53:34Z",
      "side": 1,
      "message": "And we agree with you to use command-line parameter instead of property. Some other module (zygote?) need to do the property and pass it to ART. May you help on that?",
      "parentUuid": "39580c1a_5293b206",
      "range": {
        "startLine": 40,
        "startChar": 2,
        "endLine": 66,
        "endChar": 3
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f93914b5_7606e1ad",
        "filename": "runtime/native_bridge.cc",
        "patchSetId": 5
      },
      "lineNbr": 66,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2014-07-24T06:12:40Z",
      "side": 1,
      "message": "The goal is to have this per app, and only to be pushing the parameter when necessary, i.e., we found an apk with .so files that are not host-compatible. So (a) we won\u0027t pay the price when it\u0027s unused and (b) when there is such a library, it\u0027s unlikely lazy initialization will help at all, as we should expect to be calling out into native code.",
      "parentUuid": "592ce07a_c86d2f82",
      "range": {
        "startLine": 40,
        "startChar": 2,
        "endLine": 66,
        "endChar": 3
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d9461042_d61cf105",
        "filename": "runtime/native_bridge.cc",
        "patchSetId": 5
      },
      "lineNbr": 66,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2014-07-24T06:12:40Z",
      "side": 1,
      "message": "Yes, Google will take over. Will likely not be me (as I\u0027m mainly working on Art only), but someone will take care of it. In the meantime I might accept the patch with the property.",
      "parentUuid": "1926e89c_e6ff7e40",
      "range": {
        "startLine": 40,
        "startChar": 2,
        "endLine": 66,
        "endChar": 3
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f93914b5_70d50ec8",
        "filename": "runtime/native_bridge.h",
        "patchSetId": 5
      },
      "lineNbr": 27,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2014-07-23T20:39:10Z",
      "side": 1,
      "message": "Why this way? And even if you want to go with extern and not simply include the right header files, move all of this to the .cc file.",
      "range": {
        "startLine": 25,
        "startChar": 0,
        "endLine": 27,
        "endChar": 104
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3931ecd1_c7243e9e",
        "filename": "runtime/native_bridge.h",
        "patchSetId": 5
      },
      "lineNbr": 27,
      "author": {
        "id": 1050938
      },
      "writtenOn": "2014-07-24T01:49:18Z",
      "side": 1,
      "message": "Okay we can move them to .cc file. And we use extern C because inside native-bridge it may look up that symbol in some cases (for example, native-activity may call native-bridge and register native methods before ART), looking up a mangling name looks a bit unnatural.",
      "parentUuid": "f93914b5_70d50ec8",
      "range": {
        "startLine": 25,
        "startChar": 0,
        "endLine": 27,
        "endChar": 104
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "193d089f_317e2a35",
        "filename": "runtime/native_bridge.h",
        "patchSetId": 5
      },
      "lineNbr": 61,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2014-07-23T20:39:10Z",
      "side": 1,
      "message": "Better name here, there\u0027s no need for C-style obfuscation. NativeBridgeArtCallbacks maybe.",
      "range": {
        "startLine": 61,
        "startChar": 2,
        "endLine": 61,
        "endChar": 10
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1926e89c_06a01abd",
        "filename": "runtime/native_bridge.h",
        "patchSetId": 5
      },
      "lineNbr": 61,
      "author": {
        "id": 1050938
      },
      "writtenOn": "2014-07-24T01:49:18Z",
      "side": 1,
      "message": "Okay.",
      "parentUuid": "193d089f_317e2a35",
      "range": {
        "startLine": 61,
        "startChar": 2,
        "endLine": 61,
        "endChar": 10
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "193d089f_518bb60d",
        "filename": "runtime/native_bridge.h",
        "patchSetId": 5
      },
      "lineNbr": 99,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2014-07-23T20:39:10Z",
      "side": 1,
      "message": "Similar. NativeBridgeCallbacks maybe.",
      "range": {
        "startLine": 99,
        "startChar": 2,
        "endLine": 99,
        "endChar": 10
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3931ecd1_c7f27eba",
        "filename": "runtime/native_bridge.h",
        "patchSetId": 5
      },
      "lineNbr": 99,
      "author": {
        "id": 1050938
      },
      "writtenOn": "2014-07-24T01:49:18Z",
      "side": 1,
      "message": "Okay.",
      "parentUuid": "193d089f_518bb60d",
      "range": {
        "startLine": 99,
        "startChar": 2,
        "endLine": 99,
        "endChar": 10
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "193d089f_98929a90",
        "filename": "runtime/native_bridge.h",
        "patchSetId": 5
      },
      "lineNbr": 112,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2014-07-24T06:12:40Z",
      "side": 1,
      "message": "If we make this a pointer, we can live with forward declarations in the .h file and hide all the callback structures in the .cc. You can take a look at the previous Art-Native-Bridge CL for comparison.",
      "range": {
        "startLine": 112,
        "startChar": 9,
        "endLine": 112,
        "endChar": 17
      },
      "revId": "8d69314c23e32af9c9aefe93b411598eef937d4a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}