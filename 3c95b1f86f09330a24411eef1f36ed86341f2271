{
  "comments": [
    {
      "key": {
        "uuid": "10d8e46b_90905a2e",
        "filename": "compiler/driver/compiler_driver.cc",
        "patchSetId": 3
      },
      "lineNbr": 2054,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2016-11-21T12:00:51Z",
      "side": 1,
      "message": "Why don\u0027t we simply pass the VerifierDeps as an extra parameter to VerifyClass()? That way we can avoid the extra member in Thread and a lot of indirections in the VerifierDeps. Repeatedly retrieving the VerifierDeps singleton just to compare it with null for the non-AOT case isn\u0027t exactly free.\n\nWe would need to rewrite the ParallelCompilationManager a bit to provide a worker id to Visit(), so that we can pass the right per-thread VerifierDeps.",
      "range": {
        "startLine": 2054,
        "startChar": 10,
        "endLine": 2054,
        "endChar": 48
      },
      "revId": "3c95b1f86f09330a24411eef1f36ed86341f2271",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f0e0b014_cf940195",
        "filename": "compiler/driver/compiler_driver.cc",
        "patchSetId": 3
      },
      "lineNbr": 2054,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2016-11-21T12:52:51Z",
      "side": 1,
      "message": "We talked about it with dbrazdil@, who started out passing it to VerifyClass. The problem is more about ClassLinker::VerifyClass, which would need to be aware of VerifierDeps, and IIRC, the VerifierDeps had to be passed to a couple of methods before hitting the verifier (not that I think it matters much here, but passing parameters is in the same performance scale as checking null for a thread entry).\n\nSo we went to the way we traditionally did things: put compiler-related stuff to the callbacks. We can revisit that later if you think it\u0027s worth it.",
      "parentUuid": "10d8e46b_90905a2e",
      "range": {
        "startLine": 2054,
        "startChar": 10,
        "endLine": 2054,
        "endChar": 48
      },
      "revId": "3c95b1f86f09330a24411eef1f36ed86341f2271",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f0e0b014_cf4c0144",
        "filename": "compiler/driver/compiler_driver.cc",
        "patchSetId": 3
      },
      "lineNbr": 2054,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2016-11-21T14:42:34Z",
      "side": 1,
      "message": "I like the idea of passing it to VerifyClass. It sounds better from a design point of view, rather then using the tls. You could file a bug for it so we don\u0027t forget to revisit if needed.",
      "parentUuid": "f0e0b014_cf940195",
      "range": {
        "startLine": 2054,
        "startChar": 10,
        "endLine": 2054,
        "endChar": 48
      },
      "revId": "3c95b1f86f09330a24411eef1f36ed86341f2271",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "50f25ce7_3232ce4f",
        "filename": "compiler/driver/compiler_driver.cc",
        "patchSetId": 3
      },
      "lineNbr": 2054,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2016-11-21T14:59:49Z",
      "side": 1,
      "message": "Until it gets removed by bug bankruptcy :) As a whole, we should reconsider the compiler_callbacks.",
      "parentUuid": "f0e0b014_cf4c0144",
      "range": {
        "startLine": 2054,
        "startChar": 10,
        "endLine": 2054,
        "endChar": 48
      },
      "revId": "3c95b1f86f09330a24411eef1f36ed86341f2271",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f0e0b014_cf252172",
        "filename": "runtime/verifier/verifier_deps.cc",
        "patchSetId": 3
      },
      "lineNbr": 41,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2016-11-21T14:42:34Z",
      "side": 1,
      "message": "you could move this to utils...",
      "range": {
        "startLine": 36,
        "startChar": 0,
        "endLine": 41,
        "endChar": 1
      },
      "revId": "3c95b1f86f09330a24411eef1f36ed86341f2271",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d0c80c9b_36dd1673",
        "filename": "runtime/verifier/verifier_deps.cc",
        "patchSetId": 3
      },
      "lineNbr": 41,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2016-11-21T14:59:49Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f0e0b014_cf252172",
      "range": {
        "startLine": 36,
        "startChar": 0,
        "endLine": 41,
        "endChar": 1
      },
      "revId": "3c95b1f86f09330a24411eef1f36ed86341f2271",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f0e0b014_af2ad53f",
        "filename": "runtime/verifier/verifier_deps.cc",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2016-11-21T14:42:34Z",
      "side": 1,
      "message": "That\u0027s a bit out of context. What\u0027s the *main* one? There\u0027s no reference in this function. There\u0027s also a reference to the main one somewhere else in this file as well. That needs clarification as well.",
      "range": {
        "startLine": 49,
        "startChar": 54,
        "endLine": 49,
        "endChar": 58
      },
      "revId": "3c95b1f86f09330a24411eef1f36ed86341f2271",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "70eda006_1012240a",
        "filename": "runtime/verifier/verifier_deps.cc",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2016-11-21T14:59:49Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f0e0b014_af2ad53f",
      "range": {
        "startLine": 49,
        "startChar": 54,
        "endLine": 49,
        "endChar": 58
      },
      "revId": "3c95b1f86f09330a24411eef1f36ed86341f2271",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}