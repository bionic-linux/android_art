{
  "comments": [
    {
      "key": {
        "uuid": "167c2956_e5c23067",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 55,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2015-11-02T09:03:15Z",
      "side": 1,
      "message": "only useful for target",
      "range": {
        "startLine": 55,
        "startChar": 19,
        "endLine": 55,
        "endChar": 49
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "562a227b_682c5f42",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 55,
      "author": {
        "id": 1021471
      },
      "writtenOn": "2015-11-02T19:08:58Z",
      "side": 1,
      "message": "Also true. I wanted to illustrate that PULL_SYMBOLS is a no-op when running with --host. \n\nHow to reword?",
      "parentUuid": "167c2956_e5c23067",
      "range": {
        "startLine": 55,
        "startChar": 19,
        "endLine": 55,
        "endChar": 49
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "569941f8_c2cd2698",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 55,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2015-11-03T09:04:23Z",
      "side": 1,
      "message": "maybe \"only for target\"? \"Only does anything\" is weird to parse.",
      "parentUuid": "562a227b_682c5f42",
      "range": {
        "startLine": 55,
        "startChar": 19,
        "endLine": 55,
        "endChar": 49
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "166509c4_5d356fbb",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 261,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2015-11-02T09:03:15Z",
      "side": 1,
      "message": "Fully?",
      "range": {
        "startLine": 261,
        "startChar": 2,
        "endLine": 261,
        "endChar": 11
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5625c29e_ebb0514c",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 261,
      "author": {
        "id": 1021471
      },
      "writtenOn": "2015-11-02T19:08:58Z",
      "side": 1,
      "message": "Forgot to add comments here (will do in next PS) but basically without the ulimit it would just error (didn\u0027t check if it actually wrote out the file even partially).",
      "parentUuid": "166509c4_5d356fbb",
      "range": {
        "startLine": 261,
        "startChar": 2,
        "endLine": 261,
        "endChar": 11
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "768ac5a0_80387804",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 261,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2015-11-03T09:04:23Z",
      "side": 1,
      "message": "Then say that otherwise adb would just error.",
      "parentUuid": "5625c29e_ebb0514c",
      "range": {
        "startLine": 261,
        "startChar": 2,
        "endLine": 261,
        "endChar": 11
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3694cdc0_011aaeb3",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 274,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2015-11-02T09:03:15Z",
      "side": 1,
      "message": "drop?",
      "range": {
        "startLine": 274,
        "startChar": 39,
        "endLine": 274,
        "endChar": 47
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "968f39ad_81bb1cf7",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 456,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2015-11-02T09:03:15Z",
      "side": 1,
      "message": "why bogus? Add a comment around this variable.",
      "range": {
        "startLine": 456,
        "startChar": 23,
        "endLine": 456,
        "endChar": 28
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b6399ed2_945a0a5d",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 524,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2015-10-29T23:17:03Z",
      "side": 1,
      "message": "Indent off.",
      "range": {
        "startLine": 524,
        "startChar": 13,
        "endLine": 524,
        "endChar": 31
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "eb25fa43_537be4c3",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 553,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2016-04-13T12:05:06Z",
      "side": 1,
      "message": "Why two brackets?",
      "range": {
        "startLine": 553,
        "startChar": 7,
        "endLine": 553,
        "endChar": 10
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2bc632da_ffea7f52",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 553,
      "author": {
        "id": 1003723
      },
      "writtenOn": "2016-04-13T21:46:58Z",
      "side": 1,
      "message": "there are 48 occurrences of this in art/test\n\n       [[ expression ]]\n              Return  a  status of 0 or 1 depending on the evaluation of the conditional expression expression.  Expressions are composed of the primaries described below\n              under CONDITIONAL EXPRESSIONS.  Word splitting and pathname expansion are not performed on the words between the [[ and ]]; tilde expansion,  parameter  and\n              variable  expansion,  arithmetic  expansion,  command substitution, process substitution, and quote removal are performed.  Conditional operators such as -f\n              must be unquoted to be recognized as primaries.\n\nhttp://stackoverflow.com/questions/669452/is-preferable-over-in-bash-scripts\n\nhttp://stackoverflow.com/questions/13542832/what-is-the-difference-between-single-and-double-square-brackets-in-bash",
      "parentUuid": "eb25fa43_537be4c3",
      "range": {
        "startLine": 553,
        "startChar": 7,
        "endLine": 553,
        "endChar": 10
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f66795cb_bc1f6da4",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 578,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2015-11-02T09:03:15Z",
      "side": 1,
      "message": "Why do we need this? If we were to only use the Main invocation, it would be too late/annoying to pull the oat file?",
      "range": {
        "startLine": 566,
        "startChar": 0,
        "endLine": 578,
        "endChar": 9
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7643a650_aeb6d2a3",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 578,
      "author": {
        "id": 1021471
      },
      "writtenOn": "2015-11-02T19:08:58Z",
      "side": 1,
      "message": "The way the gdb magic works is that we start out immediately in the gdb prompt , before it even runs dex2oat.\n\nSo basically we don\u0027t have the relocated core.oat file yet by the time we are in gdb, so later on if the program crashes we don\u0027t have the core.oat symbols and it just prints ??? for the stack trace.\n\nRunning dex2oat with bogus Main function arg was suggested by Andreas, it will relocate core.oat/core.art but then fail to invoke main and exit out.\n\nThen when we run it again with almost the same args it would already have that same exact core.oat/core.art file which our gdb can load.\n\n(This seemed much cleaner than trying to detect when gdb halts execution, pulling the file only then which might not exist yet, and then injecting the file into gdb).\n\nOf course this does have the downside that we could crash before the relocation happens, but then hopefully it just crashes in the same exact way when we run it for real (without the bogus args).",
      "parentUuid": "f66795cb_bc1f6da4",
      "range": {
        "startLine": 566,
        "startChar": 0,
        "endLine": 578,
        "endChar": 9
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f66795cb_1ca05968",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 578,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2015-11-03T09:04:23Z",
      "side": 1,
      "message": "Can\u0027t you just run patchoat manually?",
      "parentUuid": "7643a650_aeb6d2a3",
      "range": {
        "startLine": 566,
        "startChar": 0,
        "endLine": 578,
        "endChar": 9
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "36c12e1a_cd858977",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 578,
      "author": {
        "id": 1021471
      },
      "writtenOn": "2015-11-03T21:18:24Z",
      "side": 1,
      "message": "Do you want me to replicate all the conditions under which dalvikvm calls patchoat? That seems like it might be brittle to future change (and more complicated in the short term).",
      "parentUuid": "f66795cb_1ca05968",
      "range": {
        "startLine": 566,
        "startChar": 0,
        "endLine": 578,
        "endChar": 9
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5644e287_1ecb8d77",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 578,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2015-11-03T21:56:02Z",
      "side": 1,
      "message": "So you\u0027re saying it\u0027s less brittle to rely on two dalvikvm invocations doing the exact same thing?",
      "parentUuid": "36c12e1a_cd858977",
      "range": {
        "startLine": 566,
        "startChar": 0,
        "endLine": 578,
        "endChar": 9
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3115c084_ae2a184d",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 578,
      "author": {
        "id": 1021471
      },
      "writtenOn": "2016-02-04T19:49:50Z",
      "side": 1,
      "message": "Alex, can you jump in here with some thoughts on the conditions on which I can run patchoat directly to force a relocation?\n\nI can take a stab at replicating patchoat logic in this script but I\u0027m worried I don\u0027t thoroughly understand the complexity of the patchoat decision table.\n-------\nNicolas,\n\nWhat if we added a proper flag to dalvikvm to only relocate and then halt execution? Then we wouldn\u0027t have to rely on a funky error being thrown which I agree 100% is brittle.",
      "parentUuid": "5644e287_1ecb8d77",
      "range": {
        "startLine": 566,
        "startChar": 0,
        "endLine": 578,
        "endChar": 9
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "31fce07c_c7365dda",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 578,
      "author": {
        "id": 1047769
      },
      "writtenOn": "2016-02-04T19:54:16Z",
      "side": 1,
      "message": "Unless you are running with relocation disabled patchoat should always be run. You can run it manually and as long as the names are correct it will use your patched version. Honestly an easier solution would be to just force --no-relocate and take the /system ones.",
      "parentUuid": "3115c084_ae2a184d",
      "range": {
        "startLine": 566,
        "startChar": 0,
        "endLine": 578,
        "endChar": 9
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3115c084_619b11e8",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 578,
      "author": {
        "id": 1047769
      },
      "writtenOn": "2016-02-04T22:18:02Z",
      "side": 1,
      "message": "Note that the offset that the runtime uses for relocation is chosen randomly from between two bounds defined in the device\u0027s makefile. In other words running patchoat manually will likely not be the same bit-for-bit then running dalvik-vm twice would give you.",
      "parentUuid": "3115c084_ae2a184d",
      "range": {
        "startLine": 566,
        "startChar": 0,
        "endLine": 578,
        "endChar": 9
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "31c3005d_71f3af8d",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 578,
      "author": {
        "id": 1021471
      },
      "writtenOn": "2016-02-04T23:31:26Z",
      "side": 1,
      "message": "Nicolas, does that sound reasonable? I can have the next patch set calling patchoat directly as you requested originally.",
      "parentUuid": "3115c084_619b11e8",
      "range": {
        "startLine": 566,
        "startChar": 0,
        "endLine": 578,
        "endChar": 9
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "11f8bcd1_03cc2e8b",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 578,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2016-02-05T09:30:18Z",
      "side": 1,
      "message": "You\u0027re suggesting a dex2oat --relocate-only? How is that different than invoking patchoat on device?\n\nAlso, remind me why -Xnorelocate is not good enough for this situation?",
      "parentUuid": "31c3005d_71f3af8d",
      "range": {
        "startLine": 566,
        "startChar": 0,
        "endLine": 578,
        "endChar": 9
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f16b2868_0a653b1e",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 578,
      "author": {
        "id": 1021471
      },
      "writtenOn": "2016-02-05T18:14:49Z",
      "side": 1,
      "message": "dalvikvm has a better knowledge of the right arguments to pass to patchoat (see Alex\u0027s comments).\n\n-Xnorelocate seems undesirable since then we wouldn\u0027t be able to use this to debug any relocation-related issues.\n\nI can put up a PS that invokes patchoat on the device from the script, and we can go from there?",
      "parentUuid": "11f8bcd1_03cc2e8b",
      "range": {
        "startLine": 566,
        "startChar": 0,
        "endLine": 578,
        "endChar": 9
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2b71d253_2df4cd6d",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 622,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2016-04-13T12:05:06Z",
      "side": 1,
      "message": "Ditto.",
      "range": {
        "startLine": 622,
        "startChar": 7,
        "endLine": 622,
        "endChar": 9
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0b2b2e19_f4d698c8",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 622,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2016-04-13T12:05:06Z",
      "side": 1,
      "message": "Stray `]` character?",
      "range": {
        "startLine": 622,
        "startChar": 28,
        "endLine": 622,
        "endChar": 29
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2b71d253_cdff494a",
        "filename": "test/etc/run-test-jar",
        "patchSetId": 1
      },
      "lineNbr": 630,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2016-04-13T12:05:06Z",
      "side": 1,
      "message": "Ditto.",
      "range": {
        "startLine": 630,
        "startChar": 7,
        "endLine": 630,
        "endChar": 9
      },
      "revId": "21f8ac05147c714b2cd57578e614896943f47285",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}