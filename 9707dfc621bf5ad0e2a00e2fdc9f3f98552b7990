{
  "comments": [
    {
      "key": {
        "uuid": "89a0ac56_1b240db7",
        "filename": "runtime/instrumentation.cc",
        "patchSetId": 15
      },
      "lineNbr": 813,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2018-06-26T12:43:15Z",
      "side": 1,
      "message": "ProfilingInfo",
      "range": {
        "startLine": 813,
        "startChar": 10,
        "endLine": 813,
        "endChar": 14
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "673e5682_320d425a",
        "filename": "runtime/instrumentation.cc",
        "patchSetId": 15
      },
      "lineNbr": 813,
      "author": {
        "id": 1047769
      },
      "writtenOn": "2018-06-26T16:32:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "89a0ac56_1b240db7",
      "range": {
        "startLine": 813,
        "startChar": 10,
        "endLine": 813,
        "endChar": 14
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a0138bb1_044dc31c",
        "filename": "runtime/instrumentation.cc",
        "patchSetId": 15
      },
      "lineNbr": 815,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2018-06-26T12:43:15Z",
      "side": 1,
      "message": "Do you need to do this for newly JITted methods too, when the exit stubs are installed?",
      "range": {
        "startLine": 815,
        "startChar": 11,
        "endLine": 815,
        "endChar": 59
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "805c926b_87ff5d22",
        "filename": "runtime/instrumentation.cc",
        "patchSetId": 15
      },
      "lineNbr": 815,
      "author": {
        "id": 1047769
      },
      "writtenOn": "2018-06-26T16:32:01Z",
      "side": 1,
      "message": "The newly jited methods have their entrypoints set in this method.\n\nCommitCodeInternal -\u003e UpdateMethodsCode -\u003e UpdateMethodsCodeImpl",
      "parentUuid": "a0138bb1_044dc31c",
      "range": {
        "startLine": 815,
        "startChar": 11,
        "endLine": 815,
        "endChar": 59
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c9733669_1bc17300",
        "filename": "runtime/instrumentation.cc",
        "patchSetId": 15
      },
      "lineNbr": 815,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2018-06-26T21:41:26Z",
      "side": 1,
      "message": "I meant the SetSavedEntryPoint. I did not find the place you were doing this for newly JItted methods.",
      "parentUuid": "805c926b_87ff5d22",
      "range": {
        "startLine": 815,
        "startChar": 11,
        "endLine": 815,
        "endChar": 59
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2a636909_ea58d081",
        "filename": "runtime/instrumentation.cc",
        "patchSetId": 15
      },
      "lineNbr": 815,
      "author": {
        "id": 1047769
      },
      "writtenOn": "2018-06-26T22:17:08Z",
      "side": 1,
      "message": "yes this method is UpdateMethodsCodeImpl.\n\nWhen jit compiles something it calls CommitCode -\u003e calls CommitCodeInternal -\u003e calls UpdateMethodsCode -\u003e calls UpdateMethodsCodeImpl (this function).",
      "parentUuid": "c9733669_1bc17300",
      "range": {
        "startLine": 815,
        "startChar": 11,
        "endLine": 815,
        "endChar": 59
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cb685bf9_f473d468",
        "filename": "runtime/instrumentation.cc",
        "patchSetId": 15
      },
      "lineNbr": 815,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2018-06-27T08:49:54Z",
      "side": 1,
      "message": "Oh didn\u0027t realize this was UpdateMethodsCodeImpl. SG.",
      "parentUuid": "2a636909_ea58d081",
      "range": {
        "startLine": 815,
        "startChar": 11,
        "endLine": 815,
        "endChar": 59
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "17a4fb65_516c2520",
        "filename": "runtime/jit/jit.cc",
        "patchSetId": 15
      },
      "lineNbr": 738,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2018-06-26T12:43:15Z",
      "side": 1,
      "message": "Please also add a comment about the instrumentation check. Isn\u0027t the test a no-op with the implementation of UpdateMethodsCodeImpl?",
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "edec4665_f5b1b114",
        "filename": "runtime/jit/jit.cc",
        "patchSetId": 15
      },
      "lineNbr": 738,
      "author": {
        "id": 1047769
      },
      "writtenOn": "2018-06-26T16:32:01Z",
      "side": 1,
      "message": "yes but it\u0027ll get hit every time if we don\u0027t have this check.",
      "parentUuid": "17a4fb65_516c2520",
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ced66095_3658beb7",
        "filename": "runtime/jit/jit.cc",
        "patchSetId": 15
      },
      "lineNbr": 738,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2018-06-26T21:41:26Z",
      "side": 1,
      "message": "WDYM \"you\u0027ll get hit\"? Are you saying this is a fast path, and it\u0027s important to have it?",
      "parentUuid": "edec4665_f5b1b114",
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8d4fb183_9288c3cc",
        "filename": "runtime/jit/jit.cc",
        "patchSetId": 15
      },
      "lineNbr": 738,
      "author": {
        "id": 1047769
      },
      "writtenOn": "2018-06-26T22:17:08Z",
      "side": 1,
      "message": "I more just meant that it makes this clearer. When GetEntryPointFromQuickCompiledCode is the instrumentation entrypoint the SavedEntryPoint has a different purpose and it no longer makes sense to try to set the methods entrypoint to it.",
      "parentUuid": "ced66095_3658beb7",
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b0c19de8_eeabbdd5",
        "filename": "runtime/jit/jit_code_cache.cc",
        "patchSetId": 15
      },
      "lineNbr": 866,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2018-06-26T12:43:15Z",
      "side": 1,
      "message": "Remove?",
      "range": {
        "startLine": 865,
        "startChar": 0,
        "endLine": 866,
        "endChar": 22
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f2b99997_76773b51",
        "filename": "runtime/jit/jit_code_cache.cc",
        "patchSetId": 15
      },
      "lineNbr": 866,
      "author": {
        "id": 1047769
      },
      "writtenOn": "2018-06-26T16:32:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b0c19de8_eeabbdd5",
      "range": {
        "startLine": 865,
        "startChar": 0,
        "endLine": 866,
        "endChar": 22
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f18f69af_e46f1f56",
        "filename": "runtime/jit/jit_code_cache.cc",
        "patchSetId": 15
      },
      "lineNbr": 1824,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2018-06-26T12:43:15Z",
      "side": 1,
      "message": "What is this change for? Looks to me you could live without it?",
      "range": {
        "startLine": 1815,
        "startChar": 0,
        "endLine": 1824,
        "endChar": 56
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2cfb0061_1f7d7091",
        "filename": "runtime/jit/jit_code_cache.cc",
        "patchSetId": 15
      },
      "lineNbr": 1824,
      "author": {
        "id": 1047769
      },
      "writtenOn": "2018-06-26T16:32:01Z",
      "side": 1,
      "message": "We still want to clear the method counter since this was jit-ed once it might be again.",
      "parentUuid": "f18f69af_e46f1f56",
      "range": {
        "startLine": 1815,
        "startChar": 0,
        "endLine": 1824,
        "endChar": 56
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "20f7980e_da9810be",
        "filename": "runtime/jit/jit_code_cache.cc",
        "patchSetId": 15
      },
      "lineNbr": 1824,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2018-06-26T21:41:26Z",
      "side": 1,
      "message": "So you want a check that the entrypoint is the instrumentation stub instead right? I think that check would read better.",
      "parentUuid": "2cfb0061_1f7d7091",
      "range": {
        "startLine": 1815,
        "startChar": 0,
        "endLine": 1824,
        "endChar": 56
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d478363d_ac43924e",
        "filename": "runtime/jit/jit_code_cache.cc",
        "patchSetId": 15
      },
      "lineNbr": 1824,
      "author": {
        "id": 1047769
      },
      "writtenOn": "2018-06-26T22:17:08Z",
      "side": 1,
      "message": "no because if the code being invalidated isn\u0027t the one the method will call we don\u0027t want to clear the counter.",
      "parentUuid": "20f7980e_da9810be",
      "range": {
        "startLine": 1815,
        "startChar": 0,
        "endLine": 1824,
        "endChar": 56
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5c44297d_798e946a",
        "filename": "runtime/jit/jit_code_cache.cc",
        "patchSetId": 15
      },
      "lineNbr": 1824,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2018-06-27T08:49:54Z",
      "side": 1,
      "message": "Ah right, so how about:\n\nconst void* method_entrypoint \u003d method-\u003eGetEntryPointFromQuickCompiledCode();\n\n  if ((profiling_info !\u003d nullptr) \u0026\u0026\n      (profiling_info-\u003eGetSavedEntryPoint() \u003d\u003d header-\u003eGetEntryPoint())) {\n    // Prevent future uses of the compiled code.\n    profiling_info-\u003eSetSavedEntryPoint(nullptr);\n    // When instrumentation is set, the actual entrypoint is the one in the profiling info.\n    method_entrypoint \u003d profiling_info-\u003eGetSavedEntryPoint();\n  }\n\n   if (method_entrypoint \u003d\u003d header-\u003eGetEntryPoint()) {\n     ...\n   }",
      "parentUuid": "d478363d_ac43924e",
      "range": {
        "startLine": 1815,
        "startChar": 0,
        "endLine": 1824,
        "endChar": 56
      },
      "revId": "9707dfc621bf5ad0e2a00e2fdc9f3f98552b7990",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}