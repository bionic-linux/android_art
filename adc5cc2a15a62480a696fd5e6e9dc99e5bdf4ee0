{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "d83cf58a_d7d506d3",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-11-04T18:13:51Z",
      "side": 1,
      "message": "art-runtime isn\u0027t unused - it\u0027s used for our internal microbenchmarks on go/lem.\n\nCan you please explain a bit more what these files are and why you want to remove them?",
      "range": {
        "startLine": 10,
        "startChar": 9,
        "endLine": 11,
        "endChar": 30
      },
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b7f4edea_0ca7339b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 1535516
      },
      "writtenOn": "2022-11-05T01:53:48Z",
      "side": 1,
      "message": "I\u0027m on the roboleaf team, working on converting the soong build to bazel. We have basic support for apexes, but not support for flattened apexes. We\u0027re considering removing flattened apexes if possible.\n\nThe art-module-lib function used by art-runtime references flattened apex files. These flattened apex files are produced even when the product is supposed to be using image apexes. I have a cl, aosp/2285522, to make the image apexes not rely on these files, but this art-runtime usage blocks that cl.",
      "parentUuid": "d83cf58a_d7d506d3",
      "range": {
        "startLine": 10,
        "startChar": 9,
        "endLine": 11,
        "endChar": 30
      },
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "27e6ad3d_e0bf0713",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-11-07T15:41:19Z",
      "side": 1,
      "message": "We used to depend on flattened APEXes in our internal tests, but we got rid of that a good while ago. We should deapex them wherever we need them.\n\n\u003e The art-module-lib function used by art-runtime references flattened apex files.\n\nOh, I wasn\u0027t aware that the `\u003cxxx\u003e.com.android.art` module references depended on flattened APEXes. Do you mean that `art-runtime` only works if `TARGET_FLATTEN_APEX` is set? I could swear we\u0027ve stopped doing that.\n\nIn any case, I\u0027m happy to see this go if it doesn\u0027t break our tests, and I cannot see that it does. Roland should confirm though.",
      "parentUuid": "b7f4edea_0ca7339b",
      "range": {
        "startLine": 10,
        "startChar": 9,
        "endLine": 11,
        "endChar": 30
      },
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9ec6fd52_a278a90a",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 1535516
      },
      "writtenOn": "2022-11-07T19:11:08Z",
      "side": 1,
      "message": "Yeah, the `\u003cxxx\u003e.com.android.art` modules are for flattened apex files, built to `$ANDROID_PRODUCT_OUT/apex/...` these files are not actually installed on the device unless `TARGET_FLATTEN_APEX` is set, but are still built even if it\u0027s not. These changes I\u0027m making are trying make it so that these files are not built unless `TARGET_FLATTEN_APEX` is set.",
      "parentUuid": "27e6ad3d_e0bf0713",
      "range": {
        "startLine": 10,
        "startChar": 9,
        "endLine": 11,
        "endChar": 30
      },
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "627af0e9_53ba9ac7",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2022-11-08T11:33:29Z",
      "side": 1,
      "message": "\u003e I\u0027m on the roboleaf team, working on converting the soong build to bazel. We have basic support for apexes, but not support for flattened apexes. We\u0027re considering removing flattened apexes if possible.\n\nAdding Jiyong to comment here.\n\nI\u0027d like to confirm it is OK to remove support for flattened APEXes now. I seem to remember at least three use cases which required them:\n1. old devices where the kernel did not have proper support for activating (non-flattened) APEX packages;\n2. Android Go devices;\n3. ART Testing on the ART Buildbot (LUCI).\n\nI think these three reasons are probably all obsolete now, so it should be OK to deprecate them, but I would not want to forget any other actual use case.",
      "parentUuid": "9ec6fd52_a278a90a",
      "range": {
        "startLine": 10,
        "startChar": 9,
        "endLine": 11,
        "endChar": 30
      },
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e990fd14_2df0eace",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1535516
      },
      "writtenOn": "2022-11-03T23:13:47Z",
      "side": 1,
      "message": "Realized build_tests won\u0027t run for this cl because it\u0027s in the art/ git repository, ran them manually here:\n\nAosp:\nhttps://android-build.googleplex.com/builds/abtd/run/L03300000957197891\n\nInternal:\nhttps://android-build.googleplex.com/builds/abtd/run/L02500000957204062\nhttps://android-build.googleplex.com/builds/abtd/run/L21500000957201245\nhttps://android-build.googleplex.com/builds/abtd/run/L79200000957195475\nhttps://android-build.googleplex.com/builds/abtd/run/L74800000957201407",
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "80cd9dd8_15785afa",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1535516
      },
      "writtenOn": "2022-11-03T23:13:47Z",
      "side": 1,
      "message": "Rea",
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4dd5af46_65c70347",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1863710
      },
      "writtenOn": "2022-11-04T13:42:03Z",
      "side": 1,
      "message": "Martin, I don\u0027t know much about this. Could you please have a look? Do we even use the Android.mk file anymore?",
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a389be99_1aa95d43",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-11-04T18:13:51Z",
      "side": 1,
      "message": "Yes, we still use this and other mk files in art/, mostly for our internal tests on LUCI and Golem, and also locally.",
      "parentUuid": "4dd5af46_65c70347",
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4b896bed_2cc9673a",
        "filename": "Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 664,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-11-04T18:13:51Z",
      "side": 1,
      "message": "I think this will break.",
      "range": {
        "startLine": 664,
        "startChar": 27,
        "endLine": 664,
        "endChar": 38
      },
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3c676693_c407d199",
        "filename": "Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 664,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-11-04T18:39:01Z",
      "side": 1,
      "message": "I\u0027m starting to wonder if we can drop build-art-unbundled-golem too. Afaics it isn\u0027t used by art/tools/golem/build-target.sh. Roland, WDYT?",
      "parentUuid": "4b896bed_2cc9673a",
      "range": {
        "startLine": 664,
        "startChar": 27,
        "endLine": 664,
        "endChar": 38
      },
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "afa4396a_a914f55d",
        "filename": "Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 664,
      "author": {
        "id": 1535516
      },
      "writtenOn": "2022-11-05T01:53:48Z",
      "side": 1,
      "message": "Oh sorry, removed this too now.\n\nI ran the golem tests with this cl, it seems to work: https://golem.corp.goog/Revision?repository\u003dart\u0026revision\u003d18972\u0026patch\u003d17531",
      "parentUuid": "3c676693_c407d199",
      "range": {
        "startLine": 664,
        "startChar": 27,
        "endLine": 664,
        "endChar": 38
      },
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "46e31e09_4c4b4f3e",
        "filename": "Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 664,
      "author": {
        "id": 1535516
      },
      "writtenOn": "2022-11-07T19:11:08Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "afa4396a_a914f55d",
      "range": {
        "startLine": 664,
        "startChar": 27,
        "endLine": 664,
        "endChar": 38
      },
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "419aa4cf_3c86ed62",
        "filename": "Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 664,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2022-11-08T11:33:29Z",
      "side": 1,
      "message": "\u003e I ran the golem tests with this cl, it seems to work: https://golem.corp.goog/Revision?repository\u003dart\u0026revision\u003d18972\u0026patch\u003d17531\n\nCould you also mention this in a `Test:` stanza in the commit message?",
      "parentUuid": "46e31e09_4c4b4f3e",
      "range": {
        "startLine": 664,
        "startChar": 27,
        "endLine": 664,
        "endChar": 38
      },
      "revId": "adc5cc2a15a62480a696fd5e6e9dc99e5bdf4ee0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}