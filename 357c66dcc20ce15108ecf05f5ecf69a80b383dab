{
  "comments": [
    {
      "key": {
        "uuid": "fd5b4728_2facc9cc",
        "filename": "runtime/oat_file_assistant.cc",
        "patchSetId": 2
      },
      "lineNbr": 90,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "I don\u0027t follow this comment.\n\nWhat is the purpose of resolving symlinks? What goes wrong if the dex location is accessed from a different symlink? Won\u0027t the generated oat file be accessible from the same place regardless?",
      "range": {
        "startLine": 77,
        "startChar": 0,
        "endLine": 90,
        "endChar": 28
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "de8ee774_b51ffe20",
        "filename": "runtime/oat_file_assistant.cc",
        "patchSetId": 2
      },
      "lineNbr": 179,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "The correctness argument here is more subtle than I like. We know based solely on the dex location whether we would generate an oat file in the \u0027oat\u0027 location or the \u0027odex\u0027 location. The correctness argument is easier if we put the lock file in the same directory as the generated oat file, because if you can create the oat file, you can create the lock.\n\nThis implies preparing the output directory for the lock as well as generating the oat file, but I don\u0027t see anything wrong with that.",
      "range": {
        "startLine": 169,
        "startChar": 0,
        "endLine": 179,
        "endChar": 94
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "af65b3b6_892b9794",
        "filename": "runtime/oat_file_assistant.cc",
        "patchSetId": 2
      },
      "lineNbr": 514,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "Please add documentation describing what this function does. Call this DexLocationToOdexFilename to be consistent with the previous naming.",
      "range": {
        "startLine": 514,
        "startChar": 12,
        "endLine": 514,
        "endChar": 34
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "675b7480_cfc2971e",
        "filename": "runtime/oat_file_assistant.cc",
        "patchSetId": 2
      },
      "lineNbr": 594,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "I would prefer you make and use a general utility function that does the equivalent of \"mkdir -p\" rather than introducing this function.",
      "range": {
        "startLine": 594,
        "startChar": 12,
        "endLine": 594,
        "endChar": 34
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "73e3a646_713ce294",
        "filename": "runtime/oat_file_assistant.cc",
        "patchSetId": 2
      },
      "lineNbr": 617,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "Infer this from dex_parent_writeable_ rather than passing info as an argument.",
      "range": {
        "startLine": 617,
        "startChar": 6,
        "endLine": 617,
        "endChar": 41
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e2ab5de5_8c35c83d",
        "filename": "runtime/oat_file_assistant.cc",
        "patchSetId": 2
      },
      "lineNbr": 639,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "Why is this better than OS::FileExists?",
      "range": {
        "startLine": 638,
        "startChar": 1,
        "endLine": 639,
        "endChar": 74
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "17a87180_b0d77a69",
        "filename": "runtime/oat_file_assistant.cc",
        "patchSetId": 2
      },
      "lineNbr": 715,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "\"relevant oat info\", because it may not be the odex file.",
      "range": {
        "startLine": 715,
        "startChar": 19,
        "endLine": 715,
        "endChar": 23
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a815898b_05430734",
        "filename": "runtime/oat_file_assistant.cc",
        "patchSetId": 2
      },
      "lineNbr": 914,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "Why change the behavior of GetBestInfo? Doesn\u0027t the existing behavior do what you want?\n\nFor prebuilt apps, the oat_ file is preferred, as before.\nFor secondary dex locations, there will be no oat_ file, so odex_ is used as desired.",
      "range": {
        "startLine": 876,
        "startChar": 0,
        "endLine": 914,
        "endChar": 59
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "13b2a0e0_48721ac1",
        "filename": "runtime/oat_file_assistant.h",
        "patchSetId": 2
      },
      "lineNbr": 53,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "Why make this public?",
      "range": {
        "startLine": 50,
        "startChar": 1,
        "endLine": 53,
        "endChar": 31
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e5ab5662_545cc4ec",
        "filename": "runtime/oat_file_assistant.h",
        "patchSetId": 2
      },
      "lineNbr": 181,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "Document where the oat file will be generated, because it now depends on whether the dex location is on the system partition or not. Document that MakeUpToDate will create a directory structure if needed as a side effect.",
      "range": {
        "startLine": 172,
        "startChar": 1,
        "endLine": 181,
        "endChar": 43
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9804bba7_c8208e17",
        "filename": "runtime/oat_file_assistant.h",
        "patchSetId": 2
      },
      "lineNbr": 230,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "This documentation is out of date. I\u0027ll revise this in a future CL.",
      "range": {
        "startLine": 220,
        "startChar": 0,
        "endLine": 230,
        "endChar": 61
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "404885e6_af2e4c70",
        "filename": "runtime/oat_file_assistant.h",
        "patchSetId": 2
      },
      "lineNbr": 376,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "Why add \"NoChecks\" to the name?",
      "range": {
        "startLine": 376,
        "startChar": 41,
        "endLine": 376,
        "endChar": 49
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1d1e2518_29ad7eab",
        "filename": "runtime/oat_file_assistant.h",
        "patchSetId": 2
      },
      "lineNbr": 424,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "Call this \u0027generate_at_odex_location_\u0027.\n\nTesting whether the parent directory of the dex file is writable is a heuristic used to infer whether the dex location is preinstalled. I\u0027m concerned because there are many reasons you may or may not have permission to write the dex file directory that do not correspond to whether the dex location is preinstalled. It also means ART\u0027s behavior will change subtly depending on permissions used at runtime.\n\nI wish there was a more explicit way to tell ART which dex locations are preinstalled. That will make the behavior more obvious and I suspect simplify testing. I\u0027m not sure how to do that though. Something like a command line argument describing prefixes of dex locations that are preinstalled or not?",
      "range": {
        "startLine": 424,
        "startChar": 2,
        "endLine": 424,
        "endChar": 36
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "32e83b6c_df9bbf03",
        "filename": "runtime/oat_file_assistant.h",
        "patchSetId": 2
      },
      "lineNbr": 450,
      "author": {
        "id": 1057373
      },
      "writtenOn": "2017-05-10T14:00:15Z",
      "side": 1,
      "message": "What for specifically?",
      "range": {
        "startLine": 449,
        "startChar": 0,
        "endLine": 450,
        "endChar": 36
      },
      "revId": "357c66dcc20ce15108ecf05f5ecf69a80b383dab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}