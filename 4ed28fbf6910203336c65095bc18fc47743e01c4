{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "ef35d541_35a77893",
        "filename": "odrefresh/Android.bp",
        "patchSetId": 3
      },
      "lineNbr": 203,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2021-10-29T12:01:56Z",
      "side": 0,
      "message": "Does the test get root access without this explicit config?",
      "revId": "4ed28fbf6910203336c65095bc18fc47743e01c4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bd90f40a_f36d9af8",
        "filename": "odrefresh/Android.bp",
        "patchSetId": 3
      },
      "lineNbr": 203,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2021-10-29T13:54:54Z",
      "side": 0,
      "message": "Yes – in practice, this tests is never used directly (i.e. by running `atest art_odrefresh_tests`), but is run (on device) either via:\n* the `ArtGtestsTargetChroot` module, which uses the `test/art-gtests-target-chroot.xml` test configuration (which runs the test as root, see https://cs.android.com/android/platform/superproject/+/master:art/test/art-gtests-target-chroot.xml;l\u003d20;drc\u003d01545e8f6e7e4ecdcbec8482f46d520619025dab); or\n* the `ArtGtestsTargetInstallApex` module, which uses the `test/art-gtests-target-install-apex.xml` test configuration (which runs in a chroot environment, and thus usually does not require root access – I\u0027ll check whether that\u0027s the case for this tests module).",
      "parentUuid": "ef35d541_35a77893",
      "revId": "4ed28fbf6910203336c65095bc18fc47743e01c4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "add223ef_5b731fe0",
        "filename": "odrefresh/Android.bp",
        "patchSetId": 3
      },
      "lineNbr": 203,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2021-10-29T14:03:07Z",
      "side": 0,
      "message": "In the second case, I think this test still needs root access because it modifies a system property that only root can write to. Please check.",
      "parentUuid": "bd90f40a_f36d9af8",
      "revId": "4ed28fbf6910203336c65095bc18fc47743e01c4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f7662f5f_3b3a43a8",
        "filename": "odrefresh/Android.bp",
        "patchSetId": 3
      },
      "lineNbr": 203,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2021-10-29T14:12:35Z",
      "side": 0,
      "message": "Will do. But not that this CL is orthogonal to ensuring root access for `art_odrefresh_tests`: enabling the root preparer in an explicit test configuration here does not affect `ArtGtestsTargetChroot` nor `ArtGtestsTargetInstallApex`.\n\nAlso, my explanation was incorrect: `ArtGtestsTargetInstallApex` does not run tests in a chroot environment.",
      "parentUuid": "add223ef_5b731fe0",
      "revId": "4ed28fbf6910203336c65095bc18fc47743e01c4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4d66d2fd_026c83a9",
        "filename": "odrefresh/Android.bp",
        "patchSetId": 3
      },
      "lineNbr": 203,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2021-10-29T15:02:20Z",
      "side": 0,
      "message": "I see.",
      "parentUuid": "f7662f5f_3b3a43a8",
      "revId": "4ed28fbf6910203336c65095bc18fc47743e01c4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e916848a_d258d91a",
        "filename": "odrefresh/Android.bp",
        "patchSetId": 3
      },
      "lineNbr": 203,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2021-10-29T15:31:48Z",
      "side": 0,
      "message": "\u003e in practice, this tests is never used directly\n\nIs that accomplished through the testing APEX and art_gtests_first_only at https://cs.android.com/android/platform/superproject/+/master:art/build/apex/Android.bp;l\u003d378;drc\u003d41e56c2282bad545608d6d9711f9e4a3683354b8? Is it different from the other gtests included in it? At least some of them work fine to run directly with `atest`.\n\nThis isn\u0027t obvious so could do with some commentary.",
      "parentUuid": "4d66d2fd_026c83a9",
      "revId": "4ed28fbf6910203336c65095bc18fc47743e01c4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f36337ad_38779503",
        "filename": "odrefresh/Android.bp",
        "patchSetId": 3
      },
      "lineNbr": 203,
      "author": {
        "id": 1052644
      },
      "writtenOn": "2021-10-29T16:46:38Z",
      "side": 0,
      "message": "\u003e \u003e in practice, this tests is never used directly\n\u003e \n\u003e Is that accomplished through the testing APEX and art_gtests_first_only at https://cs.android.com/android/platform/superproject/+/master:art/build/apex/Android.bp;l\u003d378;drc\u003d41e56c2282bad545608d6d9711f9e4a3683354b8?\n\nYes.\n\n\u003e Is it different from the other gtests included in it?\n\nNo, this test is similar to other ART gtests – with the exception that there is one version of it at most (32-bit on 32-bit-only targets, 64-bit otherwise), whereas other ART gtests have 32-bit and 64-bit (if they are both supported by the target).\n\n\u003e At least some of them work fine to run directly with `atest`.\n\nI\u0027m surprised – I\u0027ll take a look. You\u0027re talking about non-standalone ART gtests on device, right?\n\n\u003e This isn\u0027t obvious so could do with some commentary.\n\nThere\u0027s some information in the commit message, but this CL is really about rectifying something that should not have been there initially – do you think we need more?",
      "parentUuid": "e916848a_d258d91a",
      "revId": "4ed28fbf6910203336c65095bc18fc47743e01c4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "265c2f9a_90049611",
        "filename": "odrefresh/Android.bp",
        "patchSetId": 3
      },
      "lineNbr": 203,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2021-10-29T17:51:21Z",
      "side": 0,
      "message": "\u003e You\u0027re talking about non-standalone ART gtests on device, right?\n\nI\u0027m talking about tests run directly with `atest`. I guess that means they\u0027re standalone (\u003d not run from inside the testing APEX?), at least in that invocation. And yes, it\u0027s on device - I just tried a few at random (art_cmdline_tests and art_libdexfile_tests).\n\nI expect all of them to work that way, actually. If there are exceptions, don\u0027t they deserve some explanation? (If none worked I\u0027d agree that a note on each wouldn\u0027t be the best way to highlight it, but now it seems that\u0027s not the case.)\n\nBtw, this particular test indeed isn\u0027t found by atest. Why is that? Wouldn\u0027t it be even better to fix that and retain this?",
      "parentUuid": "f36337ad_38779503",
      "revId": "4ed28fbf6910203336c65095bc18fc47743e01c4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}