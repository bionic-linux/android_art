{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "bf3ebfe7_2e3d2af6",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1196,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-02-20T16:23:47Z",
      "side": 1,
      "message": "Judging from a [quick experiment](https://paste.googleplex.com/6675477694513152), it seems to me that the framework normally creates the \"cache\" directory beforehand. That\u0027s good.",
      "range": {
        "startLine": 1196,
        "startChar": 22,
        "endLine": 1196,
        "endChar": 27
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "864fb14d_86d40629",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1203,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-02-20T16:23:47Z",
      "side": 1,
      "message": "The path now looks exactly the same as the one that artd/installd would generate for secondary dex files, so there\u0027s a risk of having conflicts. Besides, it matches [the pattern used by the ART Service GC](http://cs/android-internal/art/artd/path_utils.cc;l\u003d148;rcl\u003d6c72bef2ccadc78a9c5410503deb0cd0a2b5d454), meaning ART Service will aggressively delete this file during background dexopt job even if it\u0027s still needed (note that the background dexopt job doesn\u0027t necessarily dexopt all apps because we allow the OEM to override the package list).\n\nPlease consider varying this path a little bit. E.g., use \"oat_primary\" instead of \"oat\".",
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ca5c2299_8f0d2fbc",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1203,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2023-02-21T13:17:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "864fb14d_86d40629",
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "45946f32_fc6fd339",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1206,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-02-20T16:23:47Z",
      "side": 1,
      "message": "There\u0027s a function in odrefresh that has the same name but does very different things. Though it\u0027s not a big deal, this function can be changed and renamed. See my comment below.",
      "range": {
        "startLine": 1206,
        "startChar": 12,
        "endLine": 1206,
        "endChar": 33
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2431647f_dfc0b787",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1209,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-02-20T16:23:47Z",
      "side": 1,
      "message": "It\u0027s tricky that a trailing \"/\" in `path` makes a lot of difference here. It will be more straightforward if you drop this magic and rename this function to `CreateDirectory`.\n\nThen you can call `android::base::Dirname` before you pass the path to this function on line 1241.",
      "range": {
        "startLine": 1207,
        "startChar": 0,
        "endLine": 1209,
        "endChar": 57
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "549936d7_6cfa722c",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1209,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2023-02-21T13:17:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2431647f_dfc0b787",
      "range": {
        "startLine": 1207,
        "startChar": 0,
        "endLine": 1209,
        "endChar": 57
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1ee45db6_100263be",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1212,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-02-20T16:23:47Z",
      "side": 1,
      "message": "Does this call keep the setgid bit?",
      "range": {
        "startLine": 1212,
        "startChar": 8,
        "endLine": 1212,
        "endChar": 13
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b667b9a4_fe9cbdd6",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1212,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2023-02-21T13:17:44Z",
      "side": 1,
      "message": "Yes, confirmed by looking at device.",
      "parentUuid": "1ee45db6_100263be",
      "range": {
        "startLine": 1212,
        "startChar": 8,
        "endLine": 1212,
        "endChar": 13
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5d2e3a6a_c5b5603b",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1212,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-02-21T15:11:32Z",
      "side": 1,
      "message": "Thanks.",
      "parentUuid": "b667b9a4_fe9cbdd6",
      "range": {
        "startLine": 1212,
        "startChar": 8,
        "endLine": 1212,
        "endChar": 13
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d493ecc5_9e40cc90",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1227,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-02-20T16:23:47Z",
      "side": 1,
      "message": "If `oat_path` is empty then early return? And set an error message?",
      "range": {
        "startLine": 1227,
        "startChar": 14,
        "endLine": 1227,
        "endChar": 22
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cfb6cea8_6c320928",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1227,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2023-02-21T13:17:44Z",
      "side": 1,
      "message": "oat_path can be empty for tests (see comment in `GetOatPath`).",
      "parentUuid": "d493ecc5_9e40cc90",
      "range": {
        "startLine": 1227,
        "startChar": 14,
        "endLine": 1227,
        "endChar": 22
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1d464415_9d718d51",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1227,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-02-21T15:11:32Z",
      "side": 1,
      "message": "In this case, where is the runtime written to? Which piece of code determines the path?",
      "parentUuid": "cfb6cea8_6c320928",
      "range": {
        "startLine": 1227,
        "startChar": 14,
        "endLine": 1227,
        "endChar": 22
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5fb1d6ec_7af68f5c",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1227,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2023-02-21T15:36:19Z",
      "side": 1,
      "message": "In the temporary directory of the test (PWD).",
      "parentUuid": "1d464415_9d718d51",
      "range": {
        "startLine": 1227,
        "startChar": 14,
        "endLine": 1227,
        "endChar": 22
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d64a3103_1def2838",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1227,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-02-21T15:46:18Z",
      "side": 1,
      "message": "Ah, okay. It\u0027s worth adding a comment that `GetRuntimeImagePath` may return a relative path.",
      "parentUuid": "5fb1d6ec_7af68f5c",
      "range": {
        "startLine": 1227,
        "startChar": 14,
        "endLine": 1227,
        "endChar": 22
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a9a92944_298ae653",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1227,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2023-02-21T15:47:42Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d64a3103_1def2838",
      "range": {
        "startLine": 1227,
        "startChar": 14,
        "endLine": 1227,
        "endChar": 22
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f5cac656_a47dbed2",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1247,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2023-02-20T16:23:47Z",
      "side": 1,
      "message": "Optional: It will be better if the name ends with \".tmp\", to indicate that it\u0027s a temp file. E.g., `base.art.\u003cpid\u003e.tmp`.",
      "range": {
        "startLine": 1247,
        "startChar": 59,
        "endLine": 1247,
        "endChar": 91
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1e0e20f8_9e3c87f5",
        "filename": "runtime/runtime_image.cc",
        "patchSetId": 2
      },
      "lineNbr": 1247,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2023-02-21T13:17:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f5cac656_a47dbed2",
      "range": {
        "startLine": 1247,
        "startChar": 59,
        "endLine": 1247,
        "endChar": 91
      },
      "revId": "f71a834f3dc1baa7582a3b94a4391113e6828da9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}