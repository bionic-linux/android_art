A test that is only available as a DEX binary.

This tests execution of invoke-custom. There is no bytecode to emit
invoke-custom directly. This test is generated using jack-test-annotations-lib.jack
which is not a publicly supported at this time.

Test004 is the important test here.

It was built with the following command-line steps:

jack -g -cp $ANDROID_SOURCE_ROOT/out/host/linux-x86/../common/obj/JAVA_LIBRARIES/core-libart-hostdex_intermediates/classes.jack:$ANDROID_SOURCE_ROOT/out/host/linux-x86/../common/obj/JAVA_LIBRARIES/core-oj-hostdex_intermediates/classes.jack:$HOME/Downloads/jack-test-annotations-lib.jack -D sched.runner=multi-threaded -D sched.runner.thread.kind=fixed -D sched.runner.thread.fixed.count=4 -D jack.java.source.version=1.7 -D jack.android.min-api-level=o-b2 --output-jack src.jack Tests.java
jack -g -cp $ANDROID_SOURCE_ROOT/out/host/linux-x86/../common/obj/JAVA_LIBRARIES/core-libart-hostdex_intermediates/classes.jack:$ANDROID_SOURCE_ROOT/out/host/linux-x86/../common/obj/JAVA_LIBRARIES/core-oj-hostdex_intermediates/classes.jack -D sched.runner=multi-threaded -D sched.runner.thread.kind=fixed -D sched.runner.thread.fixed.count=4 -D jack.java.source.version=1.7 -D jack.android.min-api-level=o-b2 --import src.jack --output-dex .

The source code for test004 is base64 encoded here:

BEGIN com.android.jack.java7.invokecustom.test004.Tests.base64
LyoKICogQ29weXJpZ2h0IChDKSAyMDE2IFRoZSBBbmRyb2lkIE9wZW4gU291cmNlIFByb2plY3QK
ICoKICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhl
ICJMaWNlbnNlIik7CiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs
aWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBM
aWNlbnNlIGF0CiAqCiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VO
U0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQg
dG8gaW4gd3JpdGluZywgc29mdHdhcmUKICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2Ug
aXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVT
IE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAq
IFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJt
aXNzaW9ucyBhbmQKICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdl
IGNvbS5hbmRyb2lkLmphY2suamF2YTcuaW52b2tlY3VzdG9tLnRlc3QwMDQ7CgppbXBvcnQgY29t
LmFuZHJvaWQuamFjay5hbm5vdGF0aW9ucy5DYWxsZWRCeUludm9rZUN1c3RvbTsKaW1wb3J0IGNv
bS5hbmRyb2lkLmphY2suYW5ub3RhdGlvbnMuQ29uc3RhbnQ7CmltcG9ydCBjb20uYW5kcm9pZC5q
YWNrLmFubm90YXRpb25zLkxpbmtlck1ldGhvZEhhbmRsZTsKaW1wb3J0IGNvbS5hbmRyb2lkLmph
Y2suYW5ub3RhdGlvbnMuTWV0aG9kSGFuZGxlS2luZDsKCmltcG9ydCBqYXZhLmxhbmcuaW52b2tl
LkNhbGxTaXRlOwppbXBvcnQgamF2YS5sYW5nLmludm9rZS5Db25zdGFudENhbGxTaXRlOwppbXBv
cnQgamF2YS5sYW5nLmludm9rZS5NZXRob2RIYW5kbGU7CmltcG9ydCBqYXZhLmxhbmcuaW52b2tl
Lk1ldGhvZEhhbmRsZXM7CmltcG9ydCBqYXZhLmxhbmcuaW52b2tlLk1ldGhvZFR5cGU7CgpwdWJs
aWMgY2xhc3MgVGVzdHMgewoKICBwcml2YXRlIHN0YXRpYyBpbnQgYm9vdHN0cmFwUnVuQ291bnQg
PSAwOwoKICBAQ2FsbGVkQnlJbnZva2VDdXN0b20oCiAgICAgIGludm9rZU1ldGhvZEhhbmRsZSA9
IEBMaW5rZXJNZXRob2RIYW5kbGUoa2luZCA9IE1ldGhvZEhhbmRsZUtpbmQuSU5WT0tFX1NUQVRJ
QywKICAgICAgICAgIGVuY2xvc2luZ1R5cGUgPSBUZXN0cy5jbGFzcywKICAgICAgICAgIG5hbWUg
PSAibGlua2VyTWV0aG9kIiwKICAgICAgICAgIGFyZ3VtZW50VHlwZXMgPSB7TWV0aG9kSGFuZGxl
cy5Mb29rdXAuY2xhc3MsIFN0cmluZy5jbGFzcywgTWV0aG9kVHlwZS5jbGFzcywKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgYm9vbGVhbi5jbGFzcywgYnl0ZS5jbGFzcywgY2hhci5jbGFzcywg
c2hvcnQuY2xhc3MsIGludC5jbGFzcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXQu
Y2xhc3MsIGRvdWJsZS5jbGFzcywgU3RyaW5nLmNsYXNzLCBDbGFzcy5jbGFzcywgbG9uZy5jbGFz
c30pLAogICAgICBtZXRob2RIYW5kbGVFeHRyYUFyZ3MgPSB7QENvbnN0YW50KGJvb2xlYW5WYWx1
ZSA9IHRydWUpLCBAQ29uc3RhbnQoYnl0ZVZhbHVlID0gMSksCiAgICAgICAgICAgICAgICAgICAg
ICAgICBAQ29uc3RhbnQoY2hhclZhbHVlID0gJ2EnKSwgQENvbnN0YW50KHNob3J0VmFsdWUgPSAx
MDI0KSwKICAgICAgICAgICAgICAgICAgICAgICAgIEBDb25zdGFudChpbnRWYWx1ZSA9IDEpLCBA
Q29uc3RhbnQoZmxvYXRWYWx1ZSA9IDExLjFmKSwKICAgICAgICAgICAgICAgICAgICAgICAgIEBD
b25zdGFudChkb3VibGVWYWx1ZSA9IDIuMiksIEBDb25zdGFudChzdHJpbmdWYWx1ZSA9ICJIZWxs
byIpLAogICAgICAgICAgICAgICAgICAgICAgICAgQENvbnN0YW50KGNsYXNzVmFsdWUgPSBUZXN0
cy5jbGFzcyksIEBDb25zdGFudChsb25nVmFsdWUgPSAxMjM0NTY3ODlMKX0sCiAgICAgIG5hbWUg
PSAiYWRkIiwKICAgICAgcmV0dXJuVHlwZSA9IGludC5jbGFzcywKICAgICAgYXJndW1lbnRUeXBl
cyA9IHtpbnQuY2xhc3MsIGludC5jbGFzc30pCiAgcHJpdmF0ZSBzdGF0aWMgaW50IGFkZChpbnQg
YSwgaW50IGIpIHsKICAgIHJldHVybiBhICsgYjsKICB9CgogIEBTdXBwcmVzc1dhcm5pbmdzKCJ1
bnVzZWQiKQogIHByaXZhdGUgc3RhdGljIENhbGxTaXRlIGxpbmtlck1ldGhvZChNZXRob2RIYW5k
bGVzLkxvb2t1cCBjYWxsZXIsIFN0cmluZyBuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBNZXRob2RUeXBlIG1ldGhvZFR5cGUsIGJvb2xlYW4gdjEsIGJ5dGUgdjIs
IGNoYXIgdjMsIHNob3J0IHY0LCBpbnQgdjUsIGZsb2F0IHY2LCBkb3VibGUgdjcsCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyB2OCwgQ2xhc3M8Pz4gdjksIGxv
bmcgdjEwKSB0aHJvd3MgVGhyb3dhYmxlIHsKICAgIFN5c3RlbS5vdXQucHJpbnRsbigiTGlua2lu
ZyAiICsgbmFtZSArICIgIiArIG1ldGhvZFR5cGUpOwogICAgYXNzZXJ0VHJ1ZSh2MSk7CiAgICBh
c3NlcnRFcXVhbHMoMSwgdjIpOwogICAgYXNzZXJ0RXF1YWxzKCdhJywgdjMpOwogICAgYXNzZXJ0
RXF1YWxzKDEwMjQsIHY0KTsKICAgIGFzc2VydEVxdWFscygxLCB2NSk7CiAgICBhc3NlcnRFcXVh
bHMoMTEuMWYsIHY2KTsKICAgIGFzc2VydEVxdWFscygyLjIsIHY3KTsKICAgIGFzc2VydEVxdWFs
cygiSGVsbG8iLCB2OCk7CiAgICBhc3NlcnRFcXVhbHMoVGVzdHMuY2xhc3MsIHY5KTsKICAgIGFz
c2VydEVxdWFscygxMjM0NTY3ODlMLCB2MTApOwogICAgTWV0aG9kSGFuZGxlIG1oX2FkZCA9IGNh
bGxlci5maW5kU3RhdGljKFRlc3RzLmNsYXNzLCBuYW1lLCBtZXRob2RUeXBlKTsKICAgIHJldHVy
biBuZXcgQ29uc3RhbnRDYWxsU2l0ZShtaF9hZGQpOwogIH0KCiAgcHVibGljIGludCBHZXRCb290
c3RyYXBSdW5Db3VudCgpIHsKICAgIHJldHVybiBib290c3RyYXBSdW5Db3VudDsKICB9CgogIHB1
YmxpYyBzdGF0aWMgdm9pZCB0ZXN0KGludCB4LCBpbnQgeSkgdGhyb3dzIFRocm93YWJsZSB7CiAg
ICBhc3NlcnRFcXVhbHMoeCArIHksIGFkZCh4LCB5KSk7CiAgICBTeXN0ZW0ub3V0LnByaW50bG4o
eCArIHkpOwogIH0KCiAgcHVibGljIHN0YXRpYyB2b2lkIGFzc2VydFRydWUoYm9vbGVhbiB2YWx1
ZSkgewogICAgaWYgKCF2YWx1ZSkgewogICAgICB0aHJvdyBuZXcgQXNzZXJ0aW9uRXJyb3IoImFz
c2VydFRydWUgdmFsdWU6ICIgKyB2YWx1ZSk7CiAgICB9CiAgfQoKICBwdWJsaWMgc3RhdGljIHZv
aWQgYXNzZXJ0RXF1YWxzKGJ5dGUgYjEsIGJ5dGUgYjIpIHsKICAgIGlmIChiMSA9PSBiMikgeyBy
ZXR1cm47IH0KICAgIHRocm93IG5ldyBBc3NlcnRpb25FcnJvcigiYXNzZXJ0RXF1YWxzIGIxOiAi
ICsgYjEgKyAiLCBiMjogIiArIGIyKTsKICB9CgogIHB1YmxpYyBzdGF0aWMgdm9pZCBhc3NlcnRF
cXVhbHMoY2hhciBjMSwgY2hhciBjMikgewogICAgaWYgKGMxID09IGMyKSB7IHJldHVybjsgfQog
ICAgdGhyb3cgbmV3IEFzc2VydGlvbkVycm9yKCJhc3NlcnRFcXVhbHMgYzE6ICIgKyBjMSArICIs
IGMyOiAiICsgYzIpOwogIH0KCiAgcHVibGljIHN0YXRpYyB2b2lkIGFzc2VydEVxdWFscyhzaG9y
dCBzMSwgc2hvcnQgczIpIHsKICAgIGlmIChzMSA9PSBzMikgeyByZXR1cm47IH0KICAgIHRocm93
IG5ldyBBc3NlcnRpb25FcnJvcigiYXNzZXJ0RXF1YWxzIHMxOiAiICsgczEgKyAiLCBzMjogIiAr
IHMyKTsKICB9CgogIHB1YmxpYyBzdGF0aWMgdm9pZCBhc3NlcnRFcXVhbHMoaW50IGkxLCBpbnQg
aTIpIHsKICAgIGlmIChpMSA9PSBpMikgeyByZXR1cm47IH0KICAgIHRocm93IG5ldyBBc3NlcnRp
b25FcnJvcigiYXNzZXJ0RXF1YWxzIGkxOiAiICsgaTEgKyAiLCBpMjogIiArIGkyKTsKICB9Cgog
IHB1YmxpYyBzdGF0aWMgdm9pZCBhc3NlcnRFcXVhbHMobG9uZyBsMSwgbG9uZyBsMikgewogICAg
aWYgKGwxID09IGwyKSB7IHJldHVybjsgfQogICAgdGhyb3cgbmV3IEFzc2VydGlvbkVycm9yKCJh
c3NlcnRFcXVhbHMgbDE6ICIgKyBsMSArICIsIGwyOiAiICsgbDIpOwogIH0KCiAgcHVibGljIHN0
YXRpYyB2b2lkIGFzc2VydEVxdWFscyhmbG9hdCBmMSwgZmxvYXQgZjIpIHsKICAgIGlmIChmMSA9
PSBmMikgeyByZXR1cm47IH0KICAgIHRocm93IG5ldyBBc3NlcnRpb25FcnJvcigiYXNzZXJ0RXF1
YWxzIGYxOiAiICsgZjEgKyAiLCBmMjogIiArIGYyKTsKICB9CgogIHB1YmxpYyBzdGF0aWMgdm9p
ZCBhc3NlcnRFcXVhbHMoZG91YmxlIGQxLCBkb3VibGUgZDIpIHsKICAgIGlmIChkMSA9PSBkMikg
eyByZXR1cm47IH0KICAgIHRocm93IG5ldyBBc3NlcnRpb25FcnJvcigiYXNzZXJ0RXF1YWxzIGQx
OiAiICsgZDEgKyAiLCBkMjogIiArIGQyKTsKICB9CgogIHB1YmxpYyBzdGF0aWMgdm9pZCBhc3Nl
cnRFcXVhbHMoT2JqZWN0IG8sIE9iamVjdCBwKSB7CiAgICBpZiAobyA9PSBwKSB7IHJldHVybjsg
fQogICAgaWYgKG8gIT0gbnVsbCAmJiBwICE9IG51bGwgJiYgby5lcXVhbHMocCkpIHsgcmV0dXJu
OyB9CiAgICB0aHJvdyBuZXcgQXNzZXJ0aW9uRXJyb3IoImFzc2VydEVxdWFsczogbzE6ICIgKyBv
ICsgIiwgbzI6ICIgKyBwKTsKICB9CgogIHB1YmxpYyBzdGF0aWMgdm9pZCBhc3NlcnRFcXVhbHMo
U3RyaW5nIHMxLCBTdHJpbmcgczIpIHsKICAgIGlmIChzMSA9PSBzMikgewogICAgICByZXR1cm47
CiAgICB9CgogICAgaWYgKHMxICE9IG51bGwgJiYgczIgIT0gbnVsbCAmJiBzMS5lcXVhbHMoczIp
KSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aHJvdyBuZXcgQXNzZXJ0aW9uRXJyb3IoImFz
c2VydEVxdWFscyBzMTogIiArIHMxICsgIiwgczI6ICIgKyBzMik7CiAgfQp9Cg==
END com.android.jack.java7.invokecustom.test004.Tests.base64
