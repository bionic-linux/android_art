{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "5745e57d_a44696df",
        "filename": "Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 103,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-02-24T10:05:37Z",
      "side": 1,
      "message": "Please do not change the variable name in comments. It is intentionally mentioned in many places to allow searching for relevant code locations, and the user visible name, which may need to be used locally and in CI invocations, is `SOONG_CONFIG_art_module_source_build`.\n\nIn fact, I\u0027d prefer to not rewrite the variable references at all for the same reason. Is the plan to change the format of these variables outside make? If so, it may be necessary to introduce a new variable to control this one.",
      "range": {
        "startLine": 103,
        "startChar": 3,
        "endLine": 103,
        "endChar": 51
      },
      "revId": "0daaa1afd528e68161fd2b5796487ec69880ab7b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "db3b75c8_1dfa7177",
        "filename": "Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 103,
      "author": {
        "id": 1535516
      },
      "writtenOn": "2022-02-24T19:23:06Z",
      "side": 1,
      "message": "Yes, the goal was to have each namespace be a dictionary of variables in Starlark, instead of having a variable whose name is the concatenation of the namespace and variable name.\n\nI could introduce an ART_MODULE_SOURCE_BUILD variable that then sets the soong config variable when set, and update all the comments and your g3doc page to talk about that. Would that be acceptable?",
      "parentUuid": "5745e57d_a44696df",
      "range": {
        "startLine": 103,
        "startChar": 3,
        "endLine": 103,
        "endChar": 51
      },
      "revId": "0daaa1afd528e68161fd2b5796487ec69880ab7b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9d420e0f_efa56b6b",
        "filename": "Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 103,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-02-25T09:55:28Z",
      "side": 1,
      "message": "Aha. I\u0027m curious, would those Starlark dictionaries be queried directly from kati in soong_config_get?\n\n\u003e I could introduce an ART_MODULE_SOURCE_BUILD variable that then sets the soong config variable when set, and update all the comments and your g3doc page to talk about that. Would that be acceptable?\n\nYes, that sounds good, except perhaps it should be called `ART_MODULE_BUILD_FROM_SORCE` to align with `MODULE_BUILD_FROM_SOURCE`.\n\nWe could then use that variable in the .mk code rather than `$(call soong_config_get,...)`? Iow the Soong config variable would only be used to build soong.variables.",
      "parentUuid": "db3b75c8_1dfa7177",
      "range": {
        "startLine": 103,
        "startChar": 3,
        "endLine": 103,
        "endChar": 51
      },
      "revId": "0daaa1afd528e68161fd2b5796487ec69880ab7b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3cc05880_016d153b",
        "filename": "Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 103,
      "author": {
        "id": 1535516
      },
      "writtenOn": "2022-02-25T20:51:50Z",
      "side": 1,
      "message": "\u003e I\u0027m curious, would those Starlark dictionaries be queried directly from kati in soong_config_get?\n\nCurrently there\u0027s either no starlark in the build, or all the product/board config makefiles are converted to starlark, so there\u0027s no scenario where there exists a starlark dictionary that is queried from make. But if we ever do have that scenario we would try to keep make backwards compatibility, yes.\n\nI\u0027ve gone ahead and refactored the makefiles to be based around a ART_MODULE_BUILD_FROM_SORCE, keeping compatibility with SOONG_CONFIG_art_module_source_build for now because there\u0027s some stuff in internal master that needs to be changed to use ART_MODULE_BUILD_FROM_SORCE after this topic is submitted. \n\nThere are still some auto-generated files that mention SOONG_CONFIG_art_module_source_build in comments, like prebuilts/module_sdk/art/current/sdk/Android.bp. Do you have guidance on how to regenerate these files to fix the comments?",
      "parentUuid": "9d420e0f_efa56b6b",
      "range": {
        "startLine": 103,
        "startChar": 3,
        "endLine": 103,
        "endChar": 51
      },
      "revId": "0daaa1afd528e68161fd2b5796487ec69880ab7b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b8a86eba_6d855e41",
        "filename": "Android.mk",
        "patchSetId": 1
      },
      "lineNbr": 103,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-03-01T00:30:58Z",
      "side": 1,
      "message": "Thanks.\n\nThe comments in the autogenerated .bp files originalte from here: https://cs.android.com/android/platform/superproject/+/master:packages/modules/common/build/mainline_modules_sdks.py;l\u003d137;drc\u003d654d81ef49ea6061dbe174aa9bc8ae9ee72950c1\n\nAlthough I prefer referencing the \"user visible\" (ART_)MODULE_BUILD_FROM_SOURCE it\u0027s a bit complicated there since they\u0027re not known in the script. I suggest something like:\n\n    // Do not prefer prebuilt if the Soong config variable {name} in namespace {namespace} is true.\n\nRegenerating the .bp files themselves is a bit involved, so imo it\u0027s enough to fix the script and leave them be until they\u0027re regenerated for other reasons. It\u0027s just comments, after all. But in case you really want to, I suggest changing them ad-hoc with string replace instead.",
      "parentUuid": "3cc05880_016d153b",
      "range": {
        "startLine": 103,
        "startChar": 3,
        "endLine": 103,
        "endChar": 51
      },
      "revId": "0daaa1afd528e68161fd2b5796487ec69880ab7b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "02fb1015_96b37992",
        "filename": "build/Android.common_path.mk",
        "patchSetId": 1
      },
      "lineNbr": 30,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2022-02-24T10:05:37Z",
      "side": 1,
      "message": "Same here - it\u0027s a message surfaced to users.",
      "range": {
        "startLine": 30,
        "startChar": 10,
        "endLine": 30,
        "endChar": 59
      },
      "revId": "0daaa1afd528e68161fd2b5796487ec69880ab7b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "397e0006_27a68d70",
        "filename": "build/Android.common_path.mk",
        "patchSetId": 1
      },
      "lineNbr": 30,
      "author": {
        "id": 1535516
      },
      "writtenOn": "2022-02-25T20:51:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "02fb1015_96b37992",
      "range": {
        "startLine": 30,
        "startChar": 10,
        "endLine": 30,
        "endChar": 59
      },
      "revId": "0daaa1afd528e68161fd2b5796487ec69880ab7b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}