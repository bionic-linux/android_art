{
  "comments": [
    {
      "key": {
        "uuid": "86ce0325_7f148872",
        "filename": "runtime/thread_list.cc",
        "patchSetId": 6
      },
      "lineNbr": 786,
      "author": {
        "id": 1130937
      },
      "writtenOn": "2019-01-02T08:26:09Z",
      "side": 1,
      "message": "Phone screen is Freezing ,when suspend timeout.\nwe add log to find which thread is still work,and then we will find what does this thread do.\nSome times this thread is run in kernel space.\nThen we will continue check what does this thread do in kernel.\n\nIf we FATAL here, how can we debug kernel issue?\n\n\n\nbelow is one of our bug:\n\n1.\nsystem_server suspend timeout\nfrom log we can see: from 10-15 16:57:11 , thread 2774 not suspend \n\n10-15 16:57:11.674   650   664 E system_server: still not suspend: Thread[120,tid\u003d2774,Runnable,Thread*\u003d0x7db6436800,peer\u003d0x12c70c30,\"Binder:650_F\"]\n10-16 10:51:15.158   650   664 E system_server: Timed out waiting for threads to suspend, waited for 64453.484s\n10-16 10:51:15.158   650   664 E system_server: still not suspend: Thread[120,tid\u003d2774,Runnable,Thread*\u003d0x7db6436800,peer\u003d0x12c70c30,\"Binder:650_F\"]\n\n\n2.\n2774 stack:\n\"Binder:650_F\" sysTid\u003d2774\n  #00 pc 0000000000b6be9c  /system/framework/oat/arm64/services.odex (offset 0x6af000) (com.android.server.content.ContentService$ObserverNode.removeObserverLocked+444)\n  #01 pc 0000000000b6bd98  /system/framework/oat/arm64/services.odex (offset 0x6af000) (com.android.server.content.ContentService$ObserverNode.removeObserverLocked+184)\n  #02 pc 0000000000b6bd98  /system/framework/oat/arm64/services.odex (offset 0x6af000) (com.android.server.content.ContentService$ObserverNode.removeObserverLocked+184)\n  #03 pc 0000000000b6bd98  /system/framework/oat/arm64/services.odex (offset 0x6af000) (com.android.server.content.ContentService$ObserverNode.removeObserverLocked+184)\n  #04 pc 0000000000b74300  /system/framework/oat/arm64/services.odex (offset 0x6af000) (com.android.server.content.ContentService.unregisterContentObserver+112)\n  #05 pc 0000000000a01950  /system/framework/arm64/boot-framework.oat (offset 0x3cd000) (android.content.IContentService$Stub.onTransact+11152)\n  #06 pc 0000000000b7214c  /system/framework/oat/arm64/services.odex (offset 0x6af000) (com.android.server.content.ContentService.onTransact+76)\n  #07 pc 0000000000bf1588  /system/framework/arm64/boot-framework.oat (offset 0x3cd000) (android.os.Binder.execTransact+600)\n  #08 pc 0000000000558d88  /system/lib64/libart.so (art_quick_invoke_stub+584)\n  #09 pc 00000000000cfcc8  /system/lib64/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+200)\n  #10 pc 0000000000460a88  /system/lib64/libart.so (art::(anonymous namespace)::InvokeWithArgArray(art::ScopedObjectAccessAlreadyRunnable const\u0026, art::ArtMethod*, art::(anonymous namespace)::ArgArray*, art::JValue*, char const*)+104)\n  #11 pc 0000000000461e1c  /system/lib64/libart.so (art::InvokeVirtualOrInterfaceWithVarArgs(art::ScopedObjectAccessAlreadyRunnable const\u0026, _jobject*, _jmethodID*, std::__va_list)+440)\n  #12 pc 0000000000337f88  /system/lib64/libart.so (art::JNI::CallBooleanMethodV(_JNIEnv*, _jobject*, _jmethodID*, std::__va_list)+656)\n  #13 pc 00000000000c48b0  /system/lib64/libandroid_runtime.so (_JNIEnv::CallBooleanMethod(_jobject*, _jmethodID*, ...)+120)\n  #14 pc 000000000012e600  /system/lib64/libandroid_runtime.so (JavaBBinder::onTransact(unsigned int, android::Parcel const\u0026, android::Parcel*, unsigned int)+156)\n  #15 pc 000000000004fa70  /system/lib64/libbinder.so (android::BBinder::transact(unsigned int, android::Parcel const\u0026, android::Parcel*, unsigned int)+136)\n  #16 pc 000000000005ab10  /system/lib64/libbinder.so (android::IPCThreadState::executeCommand(int)+520)\n  #17 pc 000000000005a84c  /system/lib64/libbinder.so (android::IPCThreadState::getAndExecuteCommand()+156)\n  #18 pc 000000000005af14  /system/lib64/libbinder.so (android::IPCThreadState::joinThreadPool(bool)+60)\n  #19 pc 000000000007b580  /system/lib64/libbinder.so (android::PoolThread::threadLoop()+24)\n  #20 pc 000000000000f9d8  /system/lib64/libutils.so (android::Thread::_threadLoop(void*)+280)\n  #21 pc 00000000000b4ee8  /system/lib64/libandroid_runtime.so (android::AndroidRuntime::javaThreadShell(void*)+140)\n  #22 pc 0000000000081a80  /system/lib64/libc.so (__pthread_start(void*)+36)\n  #23 pc 0000000000023478  /system/lib64/libc.so (__start_thread+68)\n\n\n3. \n2774 kernel stack\nsp9832e_1h10:/proc/650/task/2774 # cat stack\n[\u003c0000000000000000\u003e] __switch_to+0xa4/0xd4\n[\u003c0000000000000000\u003e] 0xffffffc01fb74080\n[\u003c0000000000000000\u003e] 0xffffffffffffffff\n\nsp9832e_1h10:/proc/650/task/2774 # cat stack                                   \n[\u003c0000000000000000\u003e] __switch_to+0xa4/0xd4\n[\u003c0000000000000000\u003e] trace_hardirqs_on+0x8/0x1b8\n[\u003c0000000000000000\u003e] 0xffffffffffffffff\n\nsp9832e_1h10:/proc/650/task/2774 # cat stack                                   \n[\u003c0000000000000000\u003e] __switch_to+0xa4/0xd4\n[\u003c0000000000000000\u003e] return_address+0x60/0x94\n[\u003c0000000000000000\u003e] stop_eirqsoff_timing+0x74/0x150\n[\u003c0000000000000000\u003e] trace_hardirqs_on+0x98/0x1b8\n[\u003c0000000000000000\u003e] ptep_set_access_flags+0x28/0x100\n[\u003c0000000000000000\u003e] handle_mm_fault+0x980/0x1094\n[\u003c0000000000000000\u003e] do_page_fault+0x290/0x3c0\n[\u003c0000000000000000\u003e] do_translation_fault+0xc4/0xe8\n[\u003c0000000000000000\u003e] do_mem_abort+0x64/0xdc\n[\u003c0000000000000000\u003e] el0_da+0x20/0x24\n[\u003c0000000000000000\u003e] 0xffffffffffffffff\n\nsp9832e_1h10:/proc/650/task/2774 # cat stack                                   \n[\u003c0000000000000000\u003e] __switch_to+0xa4/0xd4\n[\u003c0000000000000000\u003e] return_address+0x60/0x94\n[\u003c0000000000000000\u003e] el1_irq+0x10c/0x198\n[\u003c0000000000000000\u003e] 0xffffffffffffffff\n\nsp9832e_1h10:/proc/650/task/2774 # cat stack                                   \n[\u003c0000000000000000\u003e] __switch_to+0xa4/0xd4\n[\u003c0000000000000000\u003e] handle_mm_fault+0x980/0x1094\n[\u003c0000000000000000\u003e] do_page_fault+0x290/0x3c0\n[\u003c0000000000000000\u003e] do_translation_fault+0xc4/0xe8\n[\u003c0000000000000000\u003e] do_mem_abort+0x64/0xdc\n[\u003c0000000000000000\u003e] el0_da+0x20/0x24\n[\u003c0000000000000000\u003e] 0xffffffffffffffff\n\nsp9832e_1h10:/proc/650/task/2774 # cat stack                                   \n[\u003c0000000000000000\u003e] __switch_to+0xa4/0xd4\n[\u003c0000000000000000\u003e] height_to_maxindex+0x8/0x60\n[\u003c0000000000000000\u003e] 0xffffffffffffffff",
      "range": {
        "startLine": 786,
        "startChar": 47,
        "endLine": 786,
        "endChar": 53
      },
      "revId": "a1358e600fa9f06548298406c17a868fbf1fb095",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}