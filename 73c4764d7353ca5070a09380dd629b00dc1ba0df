{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "1375ccde_16bc1d73",
        "filename": "libdexfile/dex/dex_file_verifier.cc",
        "patchSetId": 2
      },
      "lineNbr": 1712,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2024-02-05T12:56:32Z",
      "side": 1,
      "message": "Why not pull this out of the loop?\n\n    size_t available_bytes \u003d static_cast\u003csize_t\u003e(file_end - ptr_);\n    if (available_bytes \u003c\u003d size) { [error] }\n    available_bytes -\u003d size;  // Eagerly subtract one byte per character.\n    for (...) {\n      ...\n      case 0x0c:\n      case 0x0d:\n        if (UNLIKELY(available_bytes \u003c\u003d 2)) { [error] }\n        available_bytes -\u003d 1u;\n        ...\n      case 0x0e:\n        if (UNLIKELY(available_bytes \u003c\u003d 3)) { [error] }\n        available_bytes -\u003d 2u;\n        ...\n    }\n    DCHECK_EQ(available_bytes, static_cast\u003csize_t\u003e(file_end - ptr_));\n    DCHECK_NE(available_bytes, 0u);\n\nThat would also take care of the check after the loop.",
      "range": {
        "startLine": 1709,
        "startChar": 4,
        "endLine": 1712,
        "endChar": 5
      },
      "revId": "73c4764d7353ca5070a09380dd629b00dc1ba0df",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9f61df8d_ef1b0beb",
        "filename": "libdexfile/dex/dex_file_verifier.cc",
        "patchSetId": 2
      },
      "lineNbr": 1712,
      "author": {
        "id": 1889741
      },
      "writtenOn": "2024-02-05T14:12:26Z",
      "side": 1,
      "message": "Done. I slightly change the checks but the idea is the same.",
      "parentUuid": "1375ccde_16bc1d73",
      "range": {
        "startLine": 1709,
        "startChar": 4,
        "endLine": 1712,
        "endChar": 5
      },
      "revId": "73c4764d7353ca5070a09380dd629b00dc1ba0df",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a9b90f77_44e6e4cb",
        "filename": "libdexfile/dex/dex_file_verifier.cc",
        "patchSetId": 2
      },
      "lineNbr": 1712,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2024-02-05T14:18:30Z",
      "side": 1,
      "message": "OK, we can live with one extra comparison.",
      "parentUuid": "9f61df8d_ef1b0beb",
      "range": {
        "startLine": 1709,
        "startChar": 4,
        "endLine": 1712,
        "endChar": 5
      },
      "revId": "73c4764d7353ca5070a09380dd629b00dc1ba0df",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}