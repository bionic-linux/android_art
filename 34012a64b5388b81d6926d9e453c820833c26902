{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "6ebb0577_5afd9fa0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1894735
      },
      "writtenOn": "2022-10-13T10:47:32Z",
      "side": 1,
      "message": "PTAL. Thanks!",
      "revId": "34012a64b5388b81d6926d9e453c820833c26902",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "122f0360_2a695093",
        "filename": "runtime/entrypoints/quick/quick_trampoline_entrypoints.cc",
        "patchSetId": 3
      },
      "lineNbr": 2671,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2022-10-13T11:47:01Z",
      "side": 1,
      "message": "What if it\u0027s the method enter event that requests deoptimization?",
      "range": {
        "startLine": 2671,
        "startChar": 9,
        "endLine": 2671,
        "endChar": 25
      },
      "revId": "34012a64b5388b81d6926d9e453c820833c26902",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e41bdc97_137381e7",
        "filename": "runtime/entrypoints/quick/quick_trampoline_entrypoints.cc",
        "patchSetId": 3
      },
      "lineNbr": 2671,
      "author": {
        "id": 1894735
      },
      "writtenOn": "2022-10-13T14:12:58Z",
      "side": 1,
      "message": "Yes, you are right. I updated this. The reason I am looking at this is so I can change the check in JITed code to just check for method entry listeners instead of checking if there are any entry/exit stubs. I think if we don\u0027t have method entry listeners then there is no reason we need to call method entry hooks. Atleast on ArrayListStress benchmark avoiding these hooks can improve the performance by 2x. I haven\u0027t yet updated JIT check but I want to land this first to see if something breaks.",
      "parentUuid": "122f0360_2a695093",
      "range": {
        "startLine": 2671,
        "startChar": 9,
        "endLine": 2671,
        "endChar": 25
      },
      "revId": "34012a64b5388b81d6926d9e453c820833c26902",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8a9b12f7_9ee9f94c",
        "filename": "runtime/entrypoints/quick/quick_trampoline_entrypoints.cc",
        "patchSetId": 3
      },
      "lineNbr": 2671,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2022-10-13T14:19:56Z",
      "side": 1,
      "message": "What\u0027s the difference between having \"method entry listeners\" and \"any entry/exit stubs\"?",
      "parentUuid": "e41bdc97_137381e7",
      "range": {
        "startLine": 2671,
        "startChar": 9,
        "endLine": 2671,
        "endChar": 25
      },
      "revId": "34012a64b5388b81d6926d9e453c820833c26902",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c95818e6_e0c79287",
        "filename": "runtime/entrypoints/quick/quick_trampoline_entrypoints.cc",
        "patchSetId": 3
      },
      "lineNbr": 2671,
      "author": {
        "id": 1894735
      },
      "writtenOn": "2022-10-13T14:46:42Z",
      "side": 1,
      "message": "Sorry I wasn\u0027t clear. Currently we use instrumentation_stubs_installed_ to check if we need to call entry / exit hooks. This is set whenever we instrument the stack or install instrumentation / interpreter entry points.\n\nWhen setting a breakpoint we instrument the stack, update the entry point of the method that has breakpoint so that any necessary code is deoptimized. In those cases instrumentation_stubs_installed_ is set. For method exit this is required since we need to check if we need a deopt before returning. However, for method entry we don\u0027t need to. We just need to call method entry listeners and nothing else, so we can check for have_method_entry_listeners_ instead. For most debugging scenarios this won\u0027t be set so we can save on some calls.",
      "parentUuid": "8a9b12f7_9ee9f94c",
      "range": {
        "startLine": 2671,
        "startChar": 9,
        "endLine": 2671,
        "endChar": 25
      },
      "revId": "34012a64b5388b81d6926d9e453c820833c26902",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f5f3d19e_2f308c96",
        "filename": "runtime/entrypoints/quick/quick_trampoline_entrypoints.cc",
        "patchSetId": 3
      },
      "lineNbr": 2671,
      "author": {
        "id": 1894735
      },
      "writtenOn": "2022-10-14T10:09:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c95818e6_e0c79287",
      "range": {
        "startLine": 2671,
        "startChar": 9,
        "endLine": 2671,
        "endChar": 25
      },
      "revId": "34012a64b5388b81d6926d9e453c820833c26902",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}