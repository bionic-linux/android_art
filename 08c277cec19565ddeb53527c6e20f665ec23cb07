{
  "comments": [
    {
      "key": {
        "uuid": "2e60c205_f453ed92",
        "filename": "oatdump/oatdump.cc",
        "patchSetId": 1
      },
      "lineNbr": 193,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2017-04-27T09:02:43Z",
      "side": 1,
      "message": "Is this necessary? Doesn\u0027t builder_-\u003eEnd() flush the file?",
      "range": {
        "startLine": 193,
        "startChar": 8,
        "endLine": 193,
        "endChar": 37
      },
      "revId": "08c277cec19565ddeb53527c6e20f665ec23cb07",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "56ca61b9_d550cb6a",
        "filename": "oatdump/oatdump.cc",
        "patchSetId": 1
      },
      "lineNbr": 193,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2017-04-27T16:01:09Z",
      "side": 1,
      "message": "It\u0027s flushed, but not closed. It felt better to use this \"idiom\" for simplicity.",
      "parentUuid": "2e60c205_f453ed92",
      "range": {
        "startLine": 193,
        "startChar": 8,
        "endLine": 193,
        "endChar": 37
      },
      "revId": "08c277cec19565ddeb53527c6e20f665ec23cb07",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9c5ebe80_ec0e19b7",
        "filename": "oatdump/oatdump.cc",
        "patchSetId": 1
      },
      "lineNbr": 193,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2017-04-27T16:30:23Z",
      "side": 1,
      "message": "close() after a successful flush is a no-op. (Otherwise there would be no way to guarantee correct error handling.)",
      "parentUuid": "56ca61b9_d550cb6a",
      "range": {
        "startLine": 193,
        "startChar": 8,
        "endLine": 193,
        "endChar": 37
      },
      "revId": "08c277cec19565ddeb53527c6e20f665ec23cb07",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "692daf6e_39412d52",
        "filename": "oatdump/oatdump.cc",
        "patchSetId": 1
      },
      "lineNbr": 193,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2017-04-27T17:04:04Z",
      "side": 1,
      "message": "How is it a no-op? It closes the file descriptor, which flush does not. (I added this exactly because destructing the file object triggered the guards...)\n\nAll this does is add an extra datasync. Is this really a problem?",
      "parentUuid": "9c5ebe80_ec0e19b7",
      "range": {
        "startLine": 193,
        "startChar": 8,
        "endLine": 193,
        "endChar": 37
      },
      "revId": "08c277cec19565ddeb53527c6e20f665ec23cb07",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8037bb8c_d75ce868",
        "filename": "oatdump/oatdump.cc",
        "patchSetId": 1
      },
      "lineNbr": 193,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2017-04-27T17:14:08Z",
      "side": 1,
      "message": "What guards?\n\nMaybe not a no-op but it\u0027s guaranteed to succeed as there is no IO to do.",
      "parentUuid": "692daf6e_39412d52",
      "range": {
        "startLine": 193,
        "startChar": 8,
        "endLine": 193,
        "endChar": 37
      },
      "revId": "08c277cec19565ddeb53527c6e20f665ec23cb07",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cdc30d9c_3f1c12e8",
        "filename": "oatdump/oatdump.cc",
        "patchSetId": 1
      },
      "lineNbr": 193,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2017-04-27T17:15:57Z",
      "side": 1,
      "message": "FdFile guards that we introduced to ensure instances are only destructed after being flushed and closed (when we lacked deletion in dex2oat in some error cases). That\u0027s why there\u0027s FlushCloseOrErase (as a helper).",
      "parentUuid": "8037bb8c_d75ce868",
      "range": {
        "startLine": 193,
        "startChar": 8,
        "endLine": 193,
        "endChar": 37
      },
      "revId": "08c277cec19565ddeb53527c6e20f665ec23cb07",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "debfab4e_617ad6e9",
        "filename": "oatdump/oatdump.cc",
        "patchSetId": 1
      },
      "lineNbr": 193,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2017-04-27T17:26:26Z",
      "side": 1,
      "message": "Looks to me that those FdFile checks utterly break RAII. Why do we do that?",
      "parentUuid": "cdc30d9c_3f1c12e8",
      "range": {
        "startLine": 193,
        "startChar": 8,
        "endLine": 193,
        "endChar": 37
      },
      "revId": "08c277cec19565ddeb53527c6e20f665ec23cb07",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cb60812b_d062c40c",
        "filename": "oatdump/oatdump.cc",
        "patchSetId": 1
      },
      "lineNbr": 193,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2017-04-27T17:30:28Z",
      "side": 1,
      "message": "Please tell me how they utterly break RAII.\n\nFdFile has enough state to configure things. It can autoclose on destruction, if necessary. We decided it is better to make some things explicit, to correctly account for errors and make their handling explicit so we can reason about it more sanely in the presence of convoluted ownership. I don\u0027t get your complaint.\n\nIt is anyways outside the scope of a leak fix to change the whole API.",
      "parentUuid": "debfab4e_617ad6e9",
      "range": {
        "startLine": 193,
        "startChar": 8,
        "endLine": 193,
        "endChar": 37
      },
      "revId": "08c277cec19565ddeb53527c6e20f665ec23cb07",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "48fdd507_c606bd48",
        "filename": "oatdump/oatdump.cc",
        "patchSetId": 1
      },
      "lineNbr": 193,
      "author": {
        "id": 1018108
      },
      "writtenOn": "2017-04-27T18:20:46Z",
      "side": 1,
      "message": "If you encounter an error condition and want to return early, you just want stuff destroyed, you do not want to be forced to manually clean up an FdFile. That\u0027s just too error prone, you shall forget to do the cleanup in some paths.\n\nAnd yes, that\u0027s out of scope for this CL.",
      "parentUuid": "cb60812b_d062c40c",
      "range": {
        "startLine": 193,
        "startChar": 8,
        "endLine": 193,
        "endChar": 37
      },
      "revId": "08c277cec19565ddeb53527c6e20f665ec23cb07",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}